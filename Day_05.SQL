drop table if exists #input_range
drop table if exists #input_id

-- select s='3-5' into #input_range union all
-- select s='10-14' union all
-- select s='16-20' union all
-- select s='12-18' 


-- select s='1' into #input_id  union all
-- select s='5' union all
-- select s='8' union all
-- select s='11' union all
-- select s='17' union all
-- select s='32' 




select s='410238139187238-410761947885171' into #input_range union all
select s='219399455140911-220775799429667' union all
select s='554639179171989-562534654422144' union all
select s='161025943884609-161685695959748' union all
select s='116767692966321-118159425951323' union all
select s='155063483563832-156988366984404' union all
select s='303495034252550-311253804060789' union all
select s='426513263054991-426904142841073' union all
select s='417961457921778-420381837082277' union all
select s='193985197063188-199203019947316' union all
select s='85116616901337-88649703130258' union all
select s='526853352999373-530803747592845' union all
select s='82708500616945-85116616901336' union all
select s='246699318081102-248499994406475' union all
select s='446325746738667-449050536274059' union all
select s='275434486854804-279067568179185' union all
select s='226837936243182-226837936243182' union all
select s='11186112934340-17053350365849' union all
select s='100899014854113-102108850988134' union all
select s='132568360863761-139039399766737' union all
select s='166779167190613-167296218252757' union all
select s='202724380218798-209958580617010' union all
select s='225372361629798-226837936243181' union all
select s='409482784320772-410238139187238' union all
select s='217287917791699-218829242203873' union all
select s='425016807825590-425856081124833' union all
select s='525207999884196-526853352999371' union all
select s='473585443607145-480753922496691' union all
select s='54323535138382-59393937935076' union all
select s='468778429270468-469766286802711' union all
select s='190417306596404-190417306596404' union all
select s='124774261992335-128627943882299' union all
select s='112358131350059-116767692966319' union all
select s='473585443607145-476193509708588' union all
select s='102512629946737-104062192307677' union all
select s='211368890934348-213035901424495' union all
select s='78488449406874-79312644451028' union all
select s='42918186925902-48102077055306' union all
select s='374913932688446-381458727170335' union all
select s='108216544203392-109266157783449' union all
select s='108955695016421-110491259771069' union all
select s='103400283150965-104688372776733' union all
select s='281834217225461-286907221999414' union all
select s='162730635445893-163507945304068' union all
select s='539622941635085-542177170216458' union all
select s='274106067972125-275434486854802' union all
select s='165450600645022-166146710037018' union all
select s='243026871141401-246699318081101' union all
select s='486241876549667-490537559324762' union all
select s='78488449406874-79127270522699' union all
select s='294373046774078-299963735920778' union all
select s='544125283639683-551910940209583' union all
select s='402646055152127-403170497725692' union all
select s='441223359798755-441223359798755' union all
select s='454257959672621-460818405537780' union all
select s='215246092058057-216768590971394' union all
select s='496784854127870-496784854127870' union all
select s='162137806986087-162730635445893' union all
select s='392221539403379-393743951722566' union all
select s='393503713708521-394980020153879' union all
select s='387559899739219-387559899739219' union all
select s='534723094469502-537595065167931' union all
select s='135718199937845-139039399766737' union all
select s='193159859342438-196922816259798' union all
select s='434689854042673-441223359798754' union all
select s='537956516710062-540985807717470' union all
select s='400187850139609-401956717645143' union all
select s='464203701195312-469766286802711' union all
select s='212512571093638-214007547055874' union all
select s='183917882157267-190417306596404' union all
select s='505831469308554-512032826252307' union all
select s='428563009390946-429133090084590' union all
select s='454257959672620-454257959672620' union all
select s='395362691931768-396954682163262' union all
select s='356802851424429-360396796452375' union all
select s='67519435162667-67519435162667' union all
select s='75287546003981-75559391739870' union all
select s='33547900678653-36571392266644' union all
select s='423772388125644-424673085326679' union all
select s='397387809099884-398655834380491' union all
select s='104320506660349-105613817481298' union all
select s='4155745902886-7860936431633' union all
select s='426904142841073-427047654905143' union all
select s='91896955045788-96600706655892' union all
select s='72980824325900-73726326479671' union all
select s='536873360530822-538854558978613' union all
select s='233437985805122-233437985805122' union all
select s='74420923380327-74766615454143' union all
select s='354323734699283-356802851424427' union all
select s='329699964609785-329699964609785' union all
select s='107300770364740-108471933574924' union all
select s='173802084301224-173802084301224' union all
select s='168745771365792-169433478512712' union all
select s='409348609301840-410083917955219' union all
select s='383906327396801-387559899739219' union all
select s='429830519176461-430545433105621' union all
select s='161493422340304-162137806986087' union all
select s='74766615454143-74977895713523' union all
select s='168745771365792-169233423246894' union all
select s='166422333268528-167296218252757' union all
select s='496784854127870-498579994501848' union all
select s='407460888398356-408337727567771' union all
select s='168745771365792-168973588751107' union all
select s='485175984947040-486241876549666' union all
select s='124774261992334-124774261992334' union all
select s='155063483563832-156988366984404' union all
select s='394267545943256-395898495366614' union all
select s='504112665020889-508184143386620' union all
select s='408433614944838-408816958365077' union all
select s='343342670572788-350143158975076' union all
select s='72671706565997-73599302406053' union all
select s='13594007787189-19485000461640' union all
select s='61233823899900-67519435162666' union all
select s='312544387810651-320744329005284' union all
select s='402895037701177-403514298616468' union all
select s='170215929213369-170588319297907' union all
select s='262265716229790-268420281266045' union all
select s='205623760613293-207589237758442' union all
select s='446325746738667-449050536274059' union all
select s='105450463627641-106618506340158' union all
select s='312544387810651-312544387810651' union all
select s='406986539744676-407778278728530' union all
select s='213447876284083-214830154005880' union all
select s='214500550873583-215773548460430' union all
select s='551910940209583-551910940209583' union all
select s='305489671041609-308245796094076' union all
select s='54323535138382-59393937935076' union all
select s='101609651975117-102892475995397' union all
select s='414329485434383-420381837082277' union all
select s='362275685266685-370207251583470' union all
select s='71910792241986-72470729224081' union all
select s='427614174246754-428322692488788' union all
select s='216266512966068-217777796171659' union all
select s='429830519176461-430461161127537' union all
select s='408816958365077-409009848729329' union all
select s='333622855156946-337300850091509' union all
select s='286907221999415-289010239104818' union all
select s='233437985805123-240740447894518' union all
select s='142531252870642-148975347736261' union all
select s='557195693208858-559551150012166' union all
select s='42918186925902-44719632754503' union all
select s='168480067139154-169233423246894' union all
select s='165450600645022-166146710037018' union all
select s='424930954884275-425016807825590' union all
select s='167457839318523-167677634920656' union all
select s='31874060262233-38992005296605' union all
select s='4155745902886-4155745902886' union all
select s='74977895713523-75708387264463' union all
select s='374913932688446-381458727170335' union all
select s='106304567578123-107550661021219' union all
select s='218486499091571-220027212738750' union all
select s='362275685266685-367920622601138' union all
select s='27054546095850-27054546095850' union all
select s='532897666009191-535546035777496' union all
select s='425856081124833-426513263054991' union all
select s='398378451268600-399985141507847' union all
select s='408816958365077-409348609301840' union all
select s='396258324855746-397805701661059' union all
select s='166146710037018-166422333268528' union all
select s='23245547267084-27054546095850' union all
select s='173802084301224-177925387244139' union all
select s='161493422340304-161685695959748' union all
select s='343342670572787-343342670572787' union all
select s='253490114180939-260382143104680' union all
select s='399390455862175-400724185106074' union all
select s='324342870773060-329699964609784' union all
select s='429605067921822-430461161127537' union all
select s='162730635445893-163133219314310' union all
select s='142531252870642-145771956980021' union all
select s='425016807825590-425375385755407' union all
select s='255206277159483-260382143104680' union all
select s='74358416477979-74766615454143' union all
select s='72671706565997-73160315957735' union all
select s='425016807825590-425691791587759' union all
select s='291910909156427-297856760782979' union all
select s='513804126384296-520981255516890' union all
select s='405599699640516-406278705040124'


select s='233838329755675' into #input_id union all
select s='87290075486159' union all
select s='206577823702951' union all
select s='82992658633570' union all
select s='187980020706735' union all
select s='294492987453025' union all
select s='492059904325423' union all
select s='328357447693222' union all
select s='217210246778252' union all
select s='346175677298991' union all
select s='221547913832824' union all
select s='222195213458197' union all
select s='91385160882898' union all
select s='323141625325629' union all
select s='366669558278382' union all
select s='39695881030771' union all
select s='504418831210934' union all
select s='230803839479094' union all
select s='548084145052232' union all
select s='21847062003443' union all
select s='555449058555823' union all
select s='461836587955314' union all
select s='54480997610146' union all
select s='94943644304261' union all
select s='205523415050919' union all
select s='206685982679368' union all
select s='426104762347233' union all
select s='367451876172919' union all
select s='399763542815802' union all
select s='366570871768965' union all
select s='544414885150889' union all
select s='376888272872989' union all
select s='551894588426522' union all
select s='485045986579426' union all
select s='188567604134848' union all
select s='276162316533870' union all
select s='404360117919644' union all
select s='490793159691190' union all
select s='50396196931438' union all
select s='253345899181826' union all
select s='174890087459899' union all
select s='226287203309036' union all
select s='353359261380966' union all
select s='389712072640900' union all
select s='515818360010521' union all
select s='541807184984388' union all
select s='456998169599758' union all
select s='426400643660771' union all
select s='55304670926604' union all
select s='539195638908578' union all
select s='268332584931386' union all
select s='241342472173150' union all
select s='26394289073905' union all
select s='190463343186956' union all
select s='553789159758141' union all
select s='278486923741611' union all
select s='144288291976932' union all
select s='375988191028565' union all
select s='537377442195163' union all
select s='288939889804209' union all
select s='406417927929594' union all
select s='98761694705442' union all
select s='416686216143471' union all
select s='474342675388849' union all
select s='511708329913570' union all
select s='333138735188276' union all
select s='253514782696115' union all
select s='424456523761578' union all
select s='475933540282366' union all
select s='212695170150072' union all
select s='199207749697335' union all
select s='502921949375556' union all
select s='33059587482880' union all
select s='310741088925326' union all
select s='413091349837193' union all
select s='44580422546522' union all
select s='421995163138415' union all
select s='408560540327907' union all
select s='48107521258814' union all
select s='247720426660246' union all
select s='97889587251927' union all
select s='127641919605318' union all
select s='17372259793564' union all
select s='364539955211231' union all
select s='434252447239241' union all
select s='66777823344596' union all
select s='149420794849511' union all
select s='70846611327521' union all
select s='399792216813586' union all
select s='436513549191933' union all
select s='505974620698330' union all
select s='73746031115927' union all
select s='556448993139556' union all
select s='152738984124668' union all
select s='515382830300301' union all
select s='222319748901301' union all
select s='49330005167629' union all
select s='210722561502586' union all
select s='332949590180503' union all
select s='296610582358170' union all
select s='542633356097362' union all
select s='24823818521331' union all
select s='371029665086701' union all
select s='499293200288258' union all
select s='374781108217407' union all
select s='339247035446675' union all
select s='221664983187869' union all
select s='149525619332891' union all
select s='315035846089740' union all
select s='445755221677660' union all
select s='210933558992538' union all
select s='75925672096105' union all
select s='37424101573585' union all
select s='16605206479756' union all
select s='163395057701132' union all
select s='179178533067502' union all
select s='242573788498574' union all
select s='16900872881239' union all
select s='377417112827084' union all
select s='264956962523951' union all
select s='91584039854023' union all
select s='495119362552492' union all
select s='430201899413671' union all
select s='394314659595496' union all
select s='521943230544028' union all
select s='3075640053009' union all
select s='68677512264121' union all
select s='107331363201786' union all
select s='116266496212349' union all
select s='280837321103310' union all
select s='366935861955776' union all
select s='215362176089615' union all
select s='418948260074445' union all
select s='502141601799523' union all
select s='193047090931525' union all
select s='418190003209191' union all
select s='496716014045958' union all
select s='48798541739024' union all
select s='541011146070058' union all
select s='217574667817286' union all
select s='9473025150696' union all
select s='126836125620925' union all
select s='147991036024158' union all
select s='308299350401210' union all
select s='130121495200773' union all
select s='122990444739779' union all
select s='54822804809955' union all
select s='90076309460549' union all
select s='106876169641666' union all
select s='412018508316244' union all
select s='75460189028215' union all
select s='490863860322051' union all
select s='301884153827449' union all
select s='9207170401419' union all
select s='417389299089158' union all
select s='369570755401244' union all
select s='396103774517894' union all
select s='444931004198995' union all
select s='552176693042833' union all
select s='82899818444345' union all
select s='556631277889956' union all
select s='185857493526545' union all
select s='190027275212382' union all
select s='423374955336369' union all
select s='95742057633540' union all
select s='265898072882764' union all
select s='257995431527529' union all
select s='4693294478261' union all
select s='497288496945266' union all
select s='51962320361988' union all
select s='488883031896713' union all
select s='392130092688147' union all
select s='46569858225274' union all
select s='553462278678155' union all
select s='201367787088308' union all
select s='368507632396947' union all
select s='491553855663716' union all
select s='411272792792766' union all
select s='472984435637850' union all
select s='29246366531442' union all
select s='366042886593282' union all
select s='326289997393465' union all
select s='522535989941626' union all
select s='295176900643605' union all
select s='174806399990133' union all
select s='432851019113447' union all
select s='302899434121462' union all
select s='428449214790169' union all
select s='185045949678561' union all
select s='48550682144193' union all
select s='387224747298050' union all
select s='225705127390025' union all
select s='316189524913708' union all
select s='461610883821730' union all
select s='523778157380467' union all
select s='553915393449677' union all
select s='365240511031259' union all
select s='118798134972158' union all
select s='166727041251851' union all
select s='390086743149087' union all
select s='126538293613883' union all
select s='442076379150824' union all
select s='271371286587962' union all
select s='71480924976377' union all
select s='200049829439883' union all
select s='413255252897406' union all
select s='299438128677639' union all
select s='527530234206534' union all
select s='373071809287034' union all
select s='333611723353042' union all
select s='327762575039736' union all
select s='242786796362666' union all
select s='479379894566862' union all
select s='536701845973087' union all
select s='67278606146145' union all
select s='403955636394798' union all
select s='84558925544598' union all
select s='186357866504451' union all
select s='240237342658233' union all
select s='70799945505149' union all
select s='553406539188232' union all
select s='371344674212071' union all
select s='468386277931078' union all
select s='6060919060527' union all
select s='156577330843178' union all
select s='153585919537707' union all
select s='86297267848415' union all
select s='325553735304811' union all
select s='261911586752403' union all
select s='269368314813357' union all
select s='294408749391288' union all
select s='121371742060916' union all
select s='373323422439403' union all
select s='371543577546445' union all
select s='144343905280719' union all
select s='355096498731476' union all
select s='500989158269332' union all
select s='58370655904465' union all
select s='64152762782075' union all
select s='550629402584882' union all
select s='53056815692446' union all
select s='229266450896652' union all
select s='467239680265137' union all
select s='66021628890444' union all
select s='542965774950249' union all
select s='409810397319279' union all
select s='231479678462848' union all
select s='12742285469992' union all
select s='315849955888684' union all
select s='55766024569035' union all
select s='359581498680121' union all
select s='342346922990057' union all
select s='120247310520611' union all
select s='262142262476964' union all
select s='242110457152912' union all
select s='233930005607987' union all
select s='469437473917818' union all
select s='250563139228635' union all
select s='417933437859405' union all
select s='533239059573846' union all
select s='153248162890031' union all
select s='236568581661539' union all
select s='26411429025958' union all
select s='43726790823404' union all
select s='120710293156409' union all
select s='220222375045934' union all
select s='329162111352795' union all
select s='401431933770286' union all
select s='56847144321887' union all
select s='398607317547895' union all
select s='472762049634961' union all
select s='91560012631283' union all
select s='336572213847073' union all
select s='490358487531619' union all
select s='346875909145751' union all
select s='168166429556416' union all
select s='16468224719611' union all
select s='348767918908238' union all
select s='251214876858105' union all
select s='197846645901293' union all
select s='281250594348259' union all
select s='303499846583684' union all
select s='298077970441085' union all
select s='516469850639941' union all
select s='103216133203448' union all
select s='35386585810822' union all
select s='543100098418912' union all
select s='39379381994753' union all
select s='33283770541714' union all
select s='315461358543369' union all
select s='498529289450554' union all
select s='205034603038251' union all
select s='188398318208707' union all
select s='409093856098029' union all
select s='109187725234210' union all
select s='393577669885824' union all
select s='400124913984653' union all
select s='132485076191457' union all
select s='282556767947238' union all
select s='283198094758261' union all
select s='201702304680163' union all
select s='554554415156437' union all
select s='210223542737634' union all
select s='11721582623278' union all
select s='540798119671191' union all
select s='342782085131390' union all
select s='203470406052598' union all
select s='124091670436742' union all
select s='105046525764550' union all
select s='205667927155614' union all
select s='317328203095183' union all
select s='266222543517292' union all
select s='96000743124875' union all
select s='275981969125793' union all
select s='17701446858418' union all
select s='92288656314584' union all
select s='196640541463799' union all
select s='284394482719722' union all
select s='247898734406864' union all
select s='371577757190496' union all
select s='139307808626938' union all
select s='167372096113643' union all
select s='17253233106538' union all
select s='172457357654484' union all
select s='330945391886033' union all
select s='28282718164461' union all
select s='346187849738340' union all
select s='9319955494356' union all
select s='293764601833' union all
select s='390113613002487' union all
select s='305967885980239' union all
select s='76117698795632' union all
select s='240768303395748' union all
select s='520197753515377' union all
select s='549345927204278' union all
select s='248260482061581' union all
select s='393503517311472' union all
select s='314433485727624' union all
select s='244126139779328' union all
select s='365262989332783' union all
select s='407983127245676' union all
select s='333357748233687' union all
select s='321657276019712' union all
select s='74567105862433' union all
select s='461876101631046' union all
select s='211770489221090' union all
select s='463771123321002' union all
select s='37369749722231' union all
select s='83470791830535' union all
select s='17398075389669' union all
select s='218674686641581' union all
select s='40934613334691' union all
select s='116679912994638' union all
select s='99324097493215' union all
select s='41573720086791' union all
select s='176320429467648' union all
select s='359042407606285' union all
select s='399275713279645' union all
select s='46072739492271' union all
select s='103293197157571' union all
select s='325141972912276' union all
select s='366492024899389' union all
select s='492511009250607' union all
select s='106192754192897' union all
select s='430402045934568' union all
select s='49666236372929' union all
select s='316876179151342' union all
select s='114552313298291' union all
select s='70469554908072' union all
select s='61252632769517' union all
select s='490407211783617' union all
select s='336881990829303' union all
select s='152898654489481' union all
select s='123980296819669' union all
select s='552022795193195' union all
select s='540799802266536' union all
select s='482121129266323' union all
select s='19439867437303' union all
select s='11344155118984' union all
select s='231652738787927' union all
select s='157030091075651' union all
select s='6017038619888' union all
select s='236892572651411' union all
select s='144163897632779' union all
select s='59440780695175' union all
select s='368915977930709' union all
select s='436205849114149' union all
select s='189923645546664' union all
select s='295028976234994' union all
select s='129337449959120' union all
select s='416091730099499' union all
select s='33271922318433' union all
select s='480838346446469' union all
select s='338614541568289' union all
select s='257453425228136' union all
select s='160824621715357' union all
select s='283895745673284' union all
select s='146871449976674' union all
select s='440663578171334' union all
select s='114485770107314' union all
select s='300616805448663' union all
select s='449029226283799' union all
select s='77628830955871' union all
select s='417205336259658' union all
select s='102035276778144' union all
select s='164325169821396' union all
select s='561152356215473' union all
select s='25950926604082' union all
select s='35358196412308' union all
select s='322482624977569' union all
select s='214115697906627' union all
select s='518642388759545' union all
select s='60231276286436' union all
select s='179299446779062' union all
select s='256391197967969' union all
select s='183180372165068' union all
select s='414158415546782' union all
select s='2360015904948' union all
select s='91910881470020' union all
select s='397241176355165' union all
select s='521020658392481' union all
select s='403496534814587' union all
select s='164634565430790' union all
select s='76119785326986' union all
select s='235741494268946' union all
select s='8661371770445' union all
select s='148087160634401' union all
select s='59551471829644' union all
select s='225012213219804' union all
select s='553706568780401' union all
select s='9109883830700' union all
select s='139406235090639' union all
select s='477881555075184' union all
select s='56008630354155' union all
select s='290828170284083' union all
select s='485502617212727' union all
select s='381241958841141' union all
select s='100640090958968' union all
select s='376488312704954' union all
select s='346863359767981' union all
select s='211801660110267' union all
select s='517285116670053' union all
select s='496799615071792' union all
select s='478501614840967' union all
select s='21026313840817' union all
select s='477887410306026' union all
select s='260902236729748' union all
select s='148895841892938' union all
select s='39915237713123' union all
select s='68041436864131' union all
select s='374184477155360' union all
select s='78477968376340' union all
select s='21429310135645' union all
select s='58918425709342' union all
select s='284702491214437' union all
select s='163214613337718' union all
select s='327451900681117' union all
select s='24141765469961' union all
select s='520539276753661' union all
select s='498109020702503' union all
select s='493351255590173' union all
select s='198442853004852' union all
select s='415280943737692' union all
select s='192588918571623' union all
select s='283560402485462' union all
select s='296792656433768' union all
select s='1539288190010' union all
select s='253748783446517' union all
select s='62009072817062' union all
select s='199522467440845' union all
select s='24830380595957' union all
select s='64440161571608' union all
select s='204728830170940' union all
select s='452339165174937' union all
select s='461415220845205' union all
select s='265459604975324' union all
select s='397279195692432' union all
select s='238461992408025' union all
select s='131546074702920' union all
select s='230570770251944' union all
select s='305298810621427' union all
select s='5737959438947' union all
select s='516507708894745' union all
select s='129959075721190' union all
select s='130637081391564' union all
select s='134873853147530' union all
select s='154455248976239' union all
select s='23273161312576' union all
select s='440749268696461' union all
select s='236817508000327' union all
select s='398178766558396' union all
select s='374205902427211' union all
select s='135109523089225' union all
select s='35635180299733' union all
select s='210394363021952' union all
select s='21200862597261' union all
select s='102211335461145' union all
select s='487685558248300' union all
select s='89099524181031' union all
select s='359903960660306' union all
select s='475992654451232' union all
select s='424783315525213' union all
select s='271173807010811' union all
select s='47251474358478' union all
select s='482584147418124' union all
select s='67217232456118' union all
select s='315053766956492' union all
select s='172302730141861' union all
select s='235366083873350' union all
select s='369714303077356' union all
select s='293232239600651' union all
select s='110354390006007' union all
select s='194704681882424' union all
select s='132683140642860' union all
select s='423075723056757' union all
select s='100539893210306' union all
select s='259180178457341' union all
select s='375387063988036' union all
select s='69994823283086' union all
select s='43334477663588' union all
select s='315219020392277' union all
select s='251433436108184' union all
select s='328455971099282' union all
select s='205490739137543' union all
select s='261388256208299' union all
select s='313915904675973' union all
select s='313165026640229' union all
select s='397770882507982' union all
select s='85450922541538' union all
select s='302389221923671' union all
select s='21800367679128' union all
select s='505778647052270' union all
select s='5223547521036' union all
select s='93098739411039' union all
select s='543385654444850' union all
select s='283974280856121' union all
select s='124634954543217' union all
select s='179779308469731' union all
select s='529552441794054' union all
select s='7593151720930' union all
select s='228938248514933' union all
select s='198116967649920' union all
select s='74695875611596' union all
select s='190337222263737' union all
select s='477934228847032' union all
select s='449627745992741' union all
select s='428710575867732' union all
select s='295450292404369' union all
select s='286605982920518' union all
select s='466454433683719' union all
select s='287442064163453' union all
select s='466743497586312' union all
select s='47778517785461' union all
select s='301578281811863' union all
select s='296937978971795' union all
select s='309487592275955' union all
select s='353140720283391' union all
select s='55715394318974' union all
select s='410892518980141' union all
select s='213914225524605' union all
select s='359621814411273' union all
select s='109919382203911' union all
select s='302947208718298' union all
select s='180059454771208' union all
select s='113795520913611' union all
select s='93547464593420' union all
select s='317967168133606' union all
select s='143936055673501' union all
select s='475269468258095' union all
select s='360148549721499' union all
select s='534355632947912' union all
select s='143459672535405' union all
select s='177828645336640' union all
select s='118846189105450' union all
select s='311897512321876' union all
select s='516283429344891' union all
select s='36804923751964' union all
select s='191154224594398' union all
select s='202783290612257' union all
select s='214443330472635' union all
select s='125309622532192' union all
select s='127488890472967' union all
select s='527867600352744' union all
select s='405037581930874' union all
select s='131096879131805' union all
select s='87467836485841' union all
select s='275232412991795' union all
select s='307796209280324' union all
select s='281590430424513' union all
select s='79685259926406' union all
select s='218451207361609' union all
select s='413225493110387' union all
select s='85977542164316' union all
select s='76091827353625' union all
select s='327860652563067' union all
select s='189462015022160' union all
select s='247845715550240' union all
select s='77687495104074' union all
select s='448814331851717' union all
select s='368360512217682' union all
select s='102527404884451' union all
select s='158704243016443' union all
select s='449294283148017' union all
select s='513929628977036' union all
select s='149975160381496' union all
select s='174930878909884' union all
select s='333805271057082' union all
select s='213513361314338' union all
select s='329537151338846' union all
select s='789263815094' union all
select s='5150668739230' union all
select s='446004435755716' union all
select s='547325071388610' union all
select s='558583181318490' union all
select s='237102508021509' union all
select s='195431434268564' union all
select s='424223540853774' union all
select s='353166812849269' union all
select s='128398714558242' union all
select s='41050553714334' union all
select s='17845078278519' union all
select s='14851590749224' union all
select s='535722354351088' union all
select s='510356695276748' union all
select s='224425618495106' union all
select s='177908203672063' union all
select s='76747123587250' union all
select s='374328774326236' union all
select s='96901224625493' union all
select s='41048585525933' union all
select s='264252360997754' union all
select s='535449977862576' union all
select s='17683449810952' union all
select s='291253163173072' union all
select s='486831970793641' union all
select s='456708769726910' union all
select s='434297684252321' union all
select s='152615730034391' union all
select s='447942689434262' union all
select s='217884151213926' union all
select s='109642577222899' union all
select s='204000780215603' union all
select s='237109119214034' union all
select s='184431016471616' union all
select s='186098788747050' union all
select s='442582662922113' union all
select s='356939629519048' union all
select s='287461925801537' union all
select s='554210233327846' union all
select s='228606656764337' union all
select s='461162008360948' union all
select s='145370941153054' union all
select s='486228847539486' union all
select s='252465384921311' union all
select s='440422948327554' union all
select s='561961985534546' union all
select s='361668948997264' union all
select s='216228742710524' union all
select s='542697001786354' union all
select s='52906914528485' union all
select s='467355340163716' union all
select s='548153676568342' union all
select s='562729250284168' union all
select s='217727223588027' union all
select s='115928773819561' union all
select s='221320072502202' union all
select s='547770149436258' union all
select s='443179741235345' union all
select s='399345969417877' union all
select s='63638401194938' union all
select s='84860250655182' union all
select s='112049467346046' union all
select s='294317193950506' union all
select s='139415531279610' union all
select s='171665010722490' union all
select s='215161943258907' union all
select s='525693475724528' union all
select s='119533341464713' union all
select s='367599238377741' union all
select s='164668063001233' union all
select s='338931760456217' union all
select s='514949571382715' union all
select s='433690737085701' union all
select s='211114996518929' union all
select s='134917599627872' union all
select s='335159367239155' union all
select s='281808862646918' union all
select s='332455724499470' union all
select s='496243117537385' union all
select s='43381542143579' union all
select s='361109333996992' union all
select s='135891193520559' union all
select s='49254596663077' union all
select s='103191212579960' union all
select s='545363978858953' union all
select s='175499807269210' union all
select s='529497202597244' union all
select s='275260138957715' union all
select s='270204051007972' union all
select s='538544594727871' union all
select s='327549860837088' union all
select s='16028549551996' union all
select s='65031013616015' union all
select s='325150027614080' union all
select s='447849429301231' union all
select s='207610742479464' union all
select s='422201966429977' union all
select s='101494456649868' union all
select s='136403826325063' union all
select s='460967272957921' union all
select s='289826821832820' union all
select s='358534251362727' union all
select s='544578128714322' union all
select s='510909300199971' union all
select s='241704738254030' union all
select s='372544025733643' union all
select s='500967477739790' union all
select s='431510565891045' union all
select s='144048142878185' union all
select s='45676119303964' union all
select s='351062554678521' union all
select s='32184669611572' union all
select s='546810972800568' union all
select s='518063211251840' union all
select s='218696587422118' union all
select s='111651177604222' union all
select s='254276559949750' union all
select s='274686417732485' union all
select s='375965107411265' union all
select s='31997538966313' union all
select s='20633107170574' union all
select s='304714293376301' union all
select s='497024957693748' union all
select s='297669056224367' union all
select s='232711851549769' union all
select s='416232917783437' union all
select s='15305219932123' union all
select s='214818265101341' union all
select s='541859134943930' union all
select s='504119713215580' union all
select s='313182939563979' union all
select s='88214456209784' union all
select s='305939000532424' union all
select s='183879496990180' union all
select s='251080289794584' union all
select s='7257675986706' union all
select s='525656701238838' union all
select s='502822213919071' union all
select s='212651356668748' union all
select s='447018544361356' union all
select s='159222530190265' union all
select s='298175744443257' union all
select s='238746284264400' union all
select s='167004560484602' union all
select s='195985625462951' union all
select s='497358796523317' union all
select s='15166022840759' union all
select s='186795803728503' union all
select s='247781420152530' union all
select s='412604150397668' union all
select s='52496342762377' union all
select s='490510106993606' union all
select s='441792442627578' union all
select s='138957054215617' union all
select s='410267617981805' union all
select s='397396381220705' union all
select s='60644813692578' union all
select s='213766368656250' union all
select s='561314519169308' union all
select s='215132244906000' union all
select s='336724816320901' union all
select s='371331143490096' union all
select s='39096986794605' union all
select s='154077441883847' union all
select s='466539769392758' union all
select s='284830703582444' union all
select s='537462326959585' union all
select s='308129801546187' union all
select s='135003907361990' union all
select s='266766436665979' union all
select s='455623398689193' union all
select s='530513788600248' union all
select s='141700912650910' union all
select s='5615700753937' union all
select s='327363754087116' union all
select s='433337262543410' union all
select s='360144370452686' union all
select s='40417185410484' union all
select s='82695164648616' union all
select s='410444752910228' union all
select s='369297460276008' union all
select s='279748143543714' union all
select s='31448696707262' union all
select s='98791722377615' union all
select s='90028821534174' union all
select s='542445516002484' union all
select s='183188772500869' union all
select s='443664051029055' union all
select s='43645657163798' union all
select s='375893669468534' union all
select s='124131244445433' union all
select s='305902044361153' union all
select s='103579899134593' union all
select s='207506718670358' union all
select s='281649877520242' union all
select s='32004973886887' union all
select s='79520978862208' union all
select s='335906850320250' union all
select s='297196982558102' union all
select s='161708987303397' union all
select s='375352982659108' union all
select s='474049496774825' union all
select s='294093204934750' union all
select s='459681503083214' union all
select s='61337434863192' union all
select s='125551688177046' union all
select s='535029794357928' union all
select s='187150830864467' union all
select s='192592730780766' union all
select s='397649085829518' union all
select s='528161938181270' union all
select s='421039650529783' union all
select s='387114798168712' union all
select s='304063615297976' union all
select s='173627191044771' union all
select s='522203198301572' union all
select s='531173687091961' union all
select s='143347594506219' union all
select s='312209729834061' union all
select s='322868302367869' union all
select s='198773648301620' union all
select s='205091962428085' union all
select s='445920498298282' union all
select s='211776437271229' union all
select s='396873256645822' union all
select s='243720662324392' union all
select s='159755147632294' union all
select s='105419664397909' union all
select s='193273864682710' union all
select s='100507975764533' union all
select s='267380976081746' union all
select s='370537181983398' union all
select s='437972553717253' union all
select s='514093288315555' union all
select s='448500645285482' union all
select s='97256962502647' union all
select s='465773525585426' union all
select s='245057545618294' union all
select s='270027798613727' union all
select s='273402449232808' union all
select s='112517912048273' union all
select s='103608517638380' union all
select s='340675793976094' union all
select s='156236927298555' union all
select s='555169681110495' union all
select s='406174229648951' union all
select s='535929074317267' union all
select s='435107667266413' union all
select s='417371235450670' union all
select s='333717689975172' union all
select s='19480806150989' union all
select s='378024572296348' union all
select s='248354379684005' union all
select s='523677034080271' union all
select s='457769243861960' union all
select s='228823616753221' union all
select s='255331520914932' union all
select s='543088553809336' union all
select s='22677268247091' union all
select s='534072042673733' union all
select s='479953130544587' union all
select s='365942260646839' union all
select s='72954244333318' union all
select s='212146525330375' union all
select s='499153913795041' union all
select s='172574144237852' union all
select s='73601402775003' union all
select s='411970012923425' union all
select s='543236761080575' union all
select s='47868035860431' union all
select s='72715880398992' union all
select s='136501742023163' union all
select s='400522387823399' union all
select s='318486698082717' union all
select s='223908186412452' union all
select s='202239043275599' union all
select s='258929978343024' union all
select s='511036975883778' union all
select s='68647020547981' union all
select s='124057543399523' union all
select s='312318746156696' union all
select s='258616760035780' union all
select s='217510039595428' union all
select s='294454158456437' union all
select s='349202436420033' union all
select s='112091518007791' union all
select s='270088289245584' union all
select s='447445226282082' union all
select s='305753639204174' union all
select s='159886720284215' union all
select s='142322932502412' union all
select s='58300754135128' union all
select s='349365560244819' union all
select s='214686215726552' union all
select s='140310879130882' union all
select s='168468913034835' union all
select s='390525728903499' union all
select s='170837165572384' union all
select s='45547990299754' union all
select s='437434917008982' union all
select s='188931856841216' union all
select s='142942074586906' union all
select s='262422478948639' union all
select s='551089419182672' union all
select s='501107734871434' union all
select s='312508657439429' union all
select s='555767647253084' union all
select s='258302374646562' union all
select s='521947180881528' union all
select s='104056653758616' union all
select s='20674077897554' union all
select s='203518049648774' union all
select s='382471868611064' union all
select s='241383027109973' union all
select s='362228380325379' union all
select s='139434817534643' union all
select s='7312917019946' union all
select s='441499150234294' union all
select s='174562772376718' union all
select s='537801443679583' union all
select s='547435702594863' union all
select s='26979537347649' union all
select s='114368730335444' union all
select s='109423914480295' union all
select s='263224891983923' union all
select s='346760645978270' union all
select s='556531824368500' union all
select s='11475046902603' union all
select s='196282345177072' union all
select s='75735293470576' union all
select s='351339396841064' union all
select s='469682613513928' union all
select s='73689913806846' union all
select s='303868957645650' union all
select s='342888564091485' union all
select s='413807276659527' union all
select s='312508586807217' union all
select s='379110871663938' union all
select s='312204446924867' union all
select s='542921231789071' union all
select s='337817366856604' union all
select s='421085192640288' union all
select s='154853373642838' union all
select s='502899250748067' union all
select s='235120908214845' union all
select s='525387698218659' union all
select s='518597418650343' union all
select s='60935988966544' union all
select s='137910605945084' union all
select s='548335745220120' union all
select s='79359027743905' union all
select s='5117572933538' union all
select s='353974632045216' union all
select s='506796763211970' union all
select s='409188906918831' union all
select s='29167746404641' union all
select s='14331084114008' union all
select s='193481605011689' union all
select s='327382047755291' union all
select s='348161341656392' union all
select s='561228945564711' union all
select s='300306118782985' union all
select s='429498297845552' union all
select s='278250913827607' union all
select s='526579973949676' union all
select s='26346352352048' union all
select s='556975188849948' union all
select s='512573261121305' union all
select s='128996514273702' union all
select s='31180657047602' union all
select s='144390208471557' union all
select s='20230433999456' union all
select s='364849743765481' union all
select s='270618141183315' union all
select s='263486118199270' union all
select s='367998559504647' union all
select s='469930398452439' union all
select s='310640420462020' union all
select s='163517210075094' union all
select s='488827493276122' union all
select s='431371635382674' union all
select s='535838608066836' union all
select s='37269422770571' union all
select s='24345306740873' union all
select s='101752382315441' union all
select s='212381824906965' union all
select s='447140115047271' union all
select s='354346416922550' union all
select s='509558499753980' union all
select s='149340571940952'


drop table if exists #base_range



select
s
, starting = cast( left(s, CHARINDEX('-', s)-1) as bigint)
, ending = cast(SUBSTRING(s, CHARINDEX('-', s)+1, len(s)) as bigint)
into #base_range
from #input_range 


drop table if exists #base_id

select id = cast(s as bigint) into #base_id from #input_id 

select ans1 = count(distinct bi.id) -- use distinct in case the id belong to more than one ranges
from #base_range br inner join #base_id bi  
on bi.id BETWEEN br.starting and br.ending



---- Part 2

drop table if exists #merged_range

; with base as 
(
    select rn = ROW_NUMBER()OVER(order by starting, ending), * from #base_range
)
, cte as 
(
    select 
    rn
    , starting
    , ending
    , root_starting = starting
    , flex_ending = ending -- this ending can be expanded
    , root_rn = rn  from base
    union all 
    select 
    b.rn
    , b.starting
    , b.ending
    , root_starting
    , flex_ending = iif(b.ending > c.ending, b.ending, c.ending)
    , c.root_rn  
    from cte c 
    inner join base b 
    on b.rn = c.rn + 1 
    and b.starting between c.root_starting and c.flex_ending + 1
)  --  select * from cte 
, maxx as (
select root_starting,  mx = max(flex_ending) from cte 
group by root_starting
), minn as 
(
select mi = min(root_starting),   mx from maxx 
group by mx
)
select * into #merged_range from minn 
OPTION(maxrecursion 0)

 
select ans2 = sum(mx - mi + 1)
from #merged_range mr 
 where not exists   -- take out the ones that are completely embedded in other ranges, such ranges are not expanded. as the recursive CTE is looking forward, not backward
    (select * from #merged_range mr2 where mr2.mi < mr.mi and mr2.mx > mr.mx)


