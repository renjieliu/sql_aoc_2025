drop table if exists #input 

select s_id = 1, s='..@@.@@@@.' into #input union all
select s_id = 2, s='@@@.@.@.@@' union all
select s_id = 3, s='@@@@@.@.@@' union all
select s_id = 4, s='@.@@@@..@.' union all
select s_id = 5, s='@@.@@@@.@@' union all
select s_id = 6, s='.@@@@@@@.@' union all
select s_id = 7, s='.@.@.@.@@@' union all
select s_id = 8, s='@.@@@.@@@@' union all
select s_id = 9, s='.@@@@@@@@.' union all
select s_id = 10, s='@.@.@@@.@.'   


-- select s_id = 1	, s = '..@.@@@.@@@.@@@@..@@.@.@....@.@@..@.@@@@.@@...@@@...@..@@.@@@@@@@@.@@.@.@@@@@@@@.@@@....@@@@.@.@.@@.@@.@@@@@..@@...@@@.@..@..@@.@@@@.@@' into #input union all
-- select s_id = 2	, s = '.@@@@@@...@@@.@@@@@.@..@@@@@@.@@@.@@@.@@@@.@@@@.@@.@.@..@@.@..@@.@@@@@.@.@@@@@@@@@@.@@@.@.@@@@@@@@@...@@@@.@.@@.@@.@.@@@..@.@@@.@@@@@@.' union all
-- select s_id = 3	, s = '..@@@.@.@.@@@@.@@@@.@@@.@@.@@.@@@@.@@@@.@@@...@@@@@@.@.@@@..@@@@@..@@.@.@@...@@.@@.@@@.@@.@.@@@@@.@@@@.@@....@@.@@@..@@@@@@@@.@.@@@@.@.' union all
-- select s_id = 4	, s = '@..@..@@@.@@@.@@@@..@@.@@@@..@..@@..@@.@.@@@@@@@@@@@@@.@...@@@.@@@.@@@.@@@.@@.@@..@....@@@@@@@..@..@@@...@@@...@.@@@@@.@..@@@@@.@@@@@@@' union all
-- select s_id = 5	, s = '@..@...@@..@..@@@@....@@@@.@..@@@..@.@.@@@@@@@@@.@.@.@@.@.@@@..@.@.@@@.@@@@@.@..@...@@@@@@@..@@@@@.@@@@.@@.@@@..@....@@..@@.@@@.@@...@.' union all
-- select s_id = 6	, s = '@@@@.@@@.@.@@@@@@.@....@..@@.@....@@..@.@@..@@@..@@.@@@.@..@.@@.@@.@...@....@@@.@.@@.@.@@.@@..@.@....@.@.@@.@@....@@@@@@.@@@@..@.@@@@@@' union all
-- select s_id = 7	, s = '..@@.@.@@...@@@@@@@@@.@.@..@@.@@@.@@@@@@.@@..@@..@@@@.@@.@@@..@@.@.@.@..@@@@@.@@.@@@@@@@.@..@.@.@.@@.@@@.@.@@@.@@@@.@.@@..@...@@@@@..@.' union all
-- select s_id = 8	, s = '.@@@@.@@@.@@.@@@@@@@@..@@@..@@.@@@@.@.@@@..@.@@@.@.@@..@@@@..@.@.@@@...@@@.@@..@.@@@.@@@.@.@..@.@@.@@@@@..@@.@@.@@@@.@@@@.@@.@@@@...@.@' union all
-- select s_id = 9	, s = '@.@@@@@@@@.@...@...@.@@..@@.@@.@@.@@@.@..@...@@@@@.@@@@@@@@@..@@@@..@@@.@@.@@.@@@@@.@@@@@@..@@..@@@@.@@.@.@@@@@.@.@@@.@@@.@.@@.@..@.@@@' union all
-- select s_id = 10	, s = '@.@..@...@.@.@@@.@@..@@..@@@@.@@.@....@@.@@@@@@.@.@@@..@@..@..@..@.@....@@.@.@..@@@@@@..@.@.@@...@...@.@@..@@.@.@.@@@@@@.@@..@@@@.....@' union all
-- select s_id = 11	, s = '.@@...@.@@@..@...@...@@@@.@@@@@@@....@.@@@..@@@..@.@@@@..@.@@..@@.@@@.@@@@..@..@@@@..@@@..@@@@...@@@@@.@@@.@@@.@@.@@@.@.@..@@..@@@.@..@' union all
-- select s_id = 12	, s = '@@@@@@@..@@@@@@.@@@..@@@@@.@@@@...@@@@@...@@@@..@@@.@@@@@.@...@@@@.@@@.@@......@@@.@@@.@@.@@@@@@@@@@@@.@@@@@@@.@@.@@.@.@@@.@.@@@.@.@.@@' union all
-- select s_id = 13	, s = '@.@..@@@.@..@@@@@.@@@@@@@.@@@@@.@@@@.@@@..@....@@@@@@@@..@...@@..@@....@@@@@.@@@@@.@@@.@..@.@@.@..@@.@@..@.@..@@@@@@.@@@@@@@.@..@.@@@.@' union all
-- select s_id = 14	, s = '.@..@@.@.@@...@.@...@@@...@.@..@..@@...@@@@@@.@..@.@@@@..@.@@...@@@@.@.@.@.@@.@@.@@@@@@@@@@@@@.@.@@.@@@@@@@@@.@@..@..@@@.@@..@@...@.@@@' union all
-- select s_id = 15	, s = '.@@@@@@@@@..@@@@...@@@..@@@.@@.@@@@@@@...@@@@@@.@.@@@@@@...@@...@@.@...@@@..@@@@@@...@@@......@@.@@..@.@@@@.@.@.@.@@.@.@..@.@..@@@@@..@' union all
-- select s_id = 16	, s = '@.@@.@@.@.@@@.@.@@@@...@@@@@@@..@@..@.@.@@@@@...@@@@@@...@@..@.@...@@@@@@.@...@@@@@.@@@.@@@......@.@@.@@@.@@..@@@@@@..@@@.@@@.@..@@@@@@' union all
-- select s_id = 17	, s = '@@@@@@..@@@@@@...@@@@....@@.@@..@..@.@@@.@.@.@@.@@@@@@.@@@@@.@@@@@.@@@@@@@.@....@.@@@@@@@@.@....@@..@.@@@@.@@.@@@...@.@@@.@@....@@.@@@@' union all
-- select s_id = 18	, s = '.@.@..@@@..@@..@@...@@.@@@@@@@@@..@@.@.@@@@.@@.@@@@@@@.@@@@@@@.@.@@...@.@@@.@@@@.@.@.@@.@..@@@.@@@@...@@..@@@...@@@@..@.@@..@..@@@@@...' union all
-- select s_id = 19	, s = '@@.@@@@@@.@@@@@@.@@.@..@..@.@@.@@@.@@@.@@.@@@@.@.@..@@@...@@@@@.@@@..@@@@@@@.@@.@@@.@.@@@@@.@@@..@@.@@@@@@@@.@.@@....@@.@@@@@@@@@@.@@@@' union all
-- select s_id = 20	, s = '@@@@@@@.@.@.@@@@@@@@@..@.@@@..@@@..@@.@@@@@@@.@@@.@.@.@.@@..@@@..@@...@.@..@@@.@.@..@@.@..@..@.@@.@@@@@@@.@.@@@@...@@@@@.@@@@@@@@@.@..@' union all
-- select s_id = 21	, s = '@.@@@@@@@..@....@@@@@...@.@@@@@@@@@@@.@@.@..@..@.@.@.@@@.@....@..@....@@.@@@@@@@@@.@.@@@@.@@@@@@...@..@@.@@...@..@@.@..@@@@@..@@@@@..@.' union all
-- select s_id = 22	, s = '@@@@@@@@.@@@@@@@..@@..@@.@.@@@.@@..@@@.@..@@.@@@...@@....@@.@@@@.@..@@..@@@.@.@@@@@@.@@@.@@@.@@....@..@.@@..@@@@@@@..@@@@@@@.@.@...@@..' union all
-- select s_id = 23	, s = '@@.@.@@@...@@@@@.@.@@..@.@@@.@..@@@@@@@@@@@@@@..@@@@@..@...@@@@@@@@@....@.@.@@@.@@.@.@.@@@.@@.@@@@@@@.@@@..@@....@@.@@@@.@.@...@...@@.@' union all
-- select s_id = 24	, s = '.@@..@@@.@@@.@@...@@@@@@@..@.@.@@@@@@......@.@...@..@@@@..@.@@.@@@@..@@@@@@@.@@@@.@@@@.@..@@@@..@.@.@.@@.@..@@@.@@.@@.@@@.@.@@@@.@@..@@' union all
-- select s_id = 25	, s = '..@@@@@@..@@.@..@..@.@@@@..@@@.@.@@.@@.@@@.@@@@.@@@@@@@@@@@@@@@@@.@@..@@@@@.@@@..@@....@@@@@.@@.@@@.@@@@@.@@@@@@@@.@.@@@@@@@.@@.@...@.@' union all
-- select s_id = 26	, s = '@@@@..@@@@..@@@.@@@..@.@.@@.@@..@@@.@@@@@@@@@@.@@@.@@@@.@.@@@@@@@.@.@@@@@@@@@@@@@@@..@@@@@@@@...@@..@@@@.@@..@@@@.@..@.@.@@@@@@@..@@.@.' union all
-- select s_id = 27	, s = '@@.@.@@@.@@@@@.@..@@@.@..@.@@.@@@.@.@@@@@@@@....@.@@@@.@@.@@@@@...@.@.@.@@@@@@@@@.@@@@..@.@@.@@@.@@@..@....@..@@@.@@@...@@.@..@@...@.@@' union all
-- select s_id = 28	, s = '@@@.@@.@@@@.@.@@@@.@...@.@..@@.@@@..@.@..@@@.@@.@...@@@.@@@@@@.@@.@.@@@@....@@@@@.@.@@@...@@@@@@@@@@@@..@.@..@@@@.@@@...@@@@.@.@@@.@@..' union all
-- select s_id = 29	, s = '@@.@@@.@.@@.@.@@@...@@.@@@@.@..@@@.......@@.@@@@@@@@.@@@@@@@@@@.@.@.@.@..@@.@@.@@@@@..@@..@@.@..@.@@.@@@@.@@@.@.@@@...@@......@@@@@@@..' union all
-- select s_id = 30	, s = '.@.@@@.@@@...@@@@.@@.@@.@.@..@.@@@@.@@@@.@@@.@@..@@@.@@@@@@.@@@.@.@@@@....@@@@@@.@@.@@...@@@@.@@.@@@@@@@@@@..@...@@@..@..@@.@@@.@@@@.@@' union all
-- select s_id = 31	, s = '@@.@@.@@@.@@@@@@@..@@@.....@@.@@.@@@.@.@@.@@@.@@.@.@..@@@@.@.@@@@@@.@.@.@@@@.@..@@@@@@@.@.@@@...@.@@.@.@@@.@@...@....@@@@.@@@@@..@@..@.' union all
-- select s_id = 32	, s = '.@.@@@@@@@@@..@@@@@@@@@@.@@....@@@@@.@....@@@.@...@.@@@@@..@@.@@....@@@.@@.@@...@@@@...@..@.@@.@@..@.@....@..@@@@.@....@@.@@@@@@@@@.@.@' union all
-- select s_id = 33	, s = '@@@..@@@@@@.@@@@@@@.@@.@@@.@.@..@.@@.@@@@..@.@@@....@@@.@.@@.@@@..@@@@@..@@@@@..@@..@@.@.@@@@@.@@@..@@..@.@...@@.@@@.@.@@@.@@@@.@@.@.@.' union all
-- select s_id = 34	, s = '.@.@@@.@@@..@@@@@.@@@@@.@@@@@.@@@.@.@@.@@.@.@@.@@@.@@.@.@.@.@@@@@@@.@.@.@@..@@.@..@@@..@@@@@..@.@.@@.@.@@.@@@@@.@.@@.@.@@.@@.@.@@@@@.@.' union all
-- select s_id = 35	, s = '@@@@@..@@@...@.@@...@.@@.@@@@@.@@@.@@@@@@.@@@.....@.@.@@.@@@.@@@..@@@@@@..@..@@@.@@..@.@@@.@@@@.@..@@@.@.@.@@@..@@@@.@@@@@@@@.@@.@@@@@@' union all
-- select s_id = 36	, s = '@@@..@@@.@.@.@..@.@@@..@.@.@@@@.@@@@....@...@@.@@@@@@@@.@.@@.@..@@@@.@@@@@@@@@@.@@@@.@@@@@....@.@@.@@@@@@@@.@@@..@@@.@@.@....@@@.@@@@@@' union all
-- select s_id = 37	, s = '.@@@@@@@..@.@.@@@.@.@..@.@@@@@@@@.@@@@.@@@.@.@..@@..@.@@..@.@.@@@@@@@..@@@@@@@@@...@@@.@.@.@@.@@...@@@@.@.@@@@.@@@@@@@@.@@.@.@@..@@@@.@' union all
-- select s_id = 38	, s = '.@@..@.@..@@.@@@@@.@@@@...@@..@.@.@..@..@@.@@@@@@.@.@..@@@.@@@..@@@.@.@.@.@@@@@@@@@..@.@@@@@.@.@.@@@@@@@@@.@.@.@@@@.@.@@...@.@@@@@@....' union all
-- select s_id = 39	, s = '@.@@@.@.@@@@@@@....@@@.@.@@@@...@@...@@@@..@@@@@..@.@..@.@...@@@...@@@@..@@@@@@@@@@@.@...@@.@@@@@@@..@...@@@.@@@@@@@@@@@@@@@..@....@.@@' union all
-- select s_id = 40	, s = '@@@.@..@@@...@@@@.@..@@@@...@@@@.@.@@.@@@@@....@.@@@.@@@@@@.@@.@@.@..@@@@@@..@@@.@@@.@@@@@.@.@@@@@.@@.@@...@.@@@.@@@@.@@.@@.@@@..@@@.@@' union all
-- select s_id = 41	, s = '..@@@@.@@@@@.@@@@@@.@....@@@.@.@...@@.@.@@.@@..@@@@@@.@..@.@@@@@.@@.@@@..@@..@@@@@.@.@.@.@@@@@.....@@..@...@.@..@@...@.@@.@@..@@@@@@.@@' union all
-- select s_id = 42	, s = '...@@...@..@@.@@@@@.@@@@.@.@@@.@@@@@@@@@@.@..@..@@@.@@@@@@..@@@@@@.@@.@@@@.@.@@..@.@@@@..@@@@@@@..@.@@.@@@.@@@.@...@@...@..@@@@@.@@@.@.' union all
-- select s_id = 43	, s = '@@@@@@@..@@...@@@.@..@@@@@@@.@@@@@@@...@@.@@@..@@@@@..@@@@...@.@@@@.@@.@@@@@@....@@.@@@@@@@@.@.@.@@@.....@@.@..@@@@@@@.@@@@@.@@@.@@...@' union all
-- select s_id = 44	, s = '@@@@.@@.@..@@@@@.@@...@.@@..@@.@.@@@@@...@..@@.@@@@.@@.@.@@@@.@@@@.@@@@@@@@@.@@..@@@@@@..@@.@.@@@@@.@@@..@.@@@..@.@@@..@@..@@@@@@@@@.@@' union all
-- select s_id = 45	, s = '@.@@.@....@.@.@......@..@@@.@@@@@...@.@@@..@@@@@@@@@@@@@.@@@@@..@@.@@..@..@@@@@@.@@.@@@..@@.@.@.@.@@.@@..@.@@@....@.@@.@@@@@...@@..@..@' union all
-- select s_id = 46	, s = '@.@@@@@.@@@.@@..@..@@@@@@@.@.@.@@@@@.@.@@@@@@@.@@..@@@..@@.@@@@@@@..@@@@.@@@.@@@@@@@@..@@@@@@@@.@.@..@.@@@@@..@@@@.@@..@@@@@.@@@@@@.@@@' union all
-- select s_id = 47	, s = '.@@@@..@@.@@@@.@@@@..@@@.@.@...@@@...@@.@@.@@@@@@@@.@@@.@@@@..@.@@@@@@...@@..@@@@@@@@.@@@@.@@@@@@@.@.@@@@...@@@@.@.@@@.@@@@.@@@@@@.@.@@' union all
-- select s_id = 48	, s = '....@@@@..@@@@@@.@@@.@@..@@@....@.@@@.@..@@@..@.@.@@@@.@@..@.@.@..@@@..@.@@.@..@.@@@..@@@@@@.@@.....@.@....@@@.@.@@.@@.@@.@@@@.@@...@..' union all
-- select s_id = 49	, s = '..@@.@@@@.@@.@@@@@..@@@@..@@@.@@@.@.@@@@@@@@@..@@.@@@.@@@.@@@@.@@..@@.@@@.@@.@..@@@@@@.@@.@...@..@@@.@@.@.@@@...@@.@@.@@.@@@@@@@....@..' union all
-- select s_id = 50	, s = '.@@@@.@.@@@@@@@@....@@@.@@@@@...@.@.@@@@@@@@@@.@@@@...@@.@@@@@@@.@@@@.@..@.@@@@.@.@@@@@@.@.@@@@.@.@.@@.@@...@@@.@.@@@@@...@@@.@.@..@@.@' union all
-- select s_id = 51	, s = '@...@@@@@.@.@@..@.@.@.@@@..@@.@.@@.@@@@@@@..@@.@@@@.@@..@@..@@@@...@.@@@@@@@...@.@@@@@@@@@@.@.@@@@@@.@@@.@@@@...@@@@@.@.@..@.@.@@@@@@.@' union all
-- select s_id = 52	, s = '@@@@@@@@@@@..@@..@.@@@..@@@@@..@@@@@.@.@@@..@@@.@.@@@.@...@@@@@@.@@..@@.@@@@@@@@@@.@.@.@@@@..@@..@@..@.@.@@...@@@.....@..@@.@@@@.@@@@.@' union all
-- select s_id = 53	, s = '.@.@@@.@@@@@@@.@@@@.@@@@@@.@@.@@@..@@.@.@@@@.@@.@@@@@...@@@@.@.@@.@..@..@@.@.@.@@@..@@@..@@...@@@@.@@@.@@@@@@@@...@@@@@@@...@@.@.@@@.@@' union all
-- select s_id = 54	, s = '@@.@@@@@.@..@@@@@@@@...@@.@..@@@@@@@@@.@@.@..@@.@@@.@@@.@@.@@.@@@.@...@.@@@@@@.@@.@.@@@@.@....@@@.@@@@..@.@@@.@.@@@.@..@@..@.@@.@.@@@.@' union all
-- select s_id = 55	, s = '@@@....@@...@@@@.@.@.@@@@....@@@.@@@.@@.@@@@@@@.@@@.@@@..@@.@@..@.@@.@..@@@@@@@@..@@..@@@@..@.@@@@@..@@..@@@.@@..@@@@@@@.@.@.@@.@@@...@' union all
-- select s_id = 56	, s = '@@.....@@.@@@..@@@.@.....@.@@@.@.@@@@.@@@@@@@@@@@.@@@@@.@.@@.@@@@@@@...@@.@.@.@@.@@@@.@.@@.@.@@@@....@@@.@@@.@@.@@@@.@@@@@@.@@@@@..@.@@' union all
-- select s_id = 57	, s = '.@.@@@..@.@@@.@.@@.@@.@.@@@.@@..@@@@.@...@@@@..@@@@@@@@@@@@@@.@@@.@@@@@@@@@@@@@@@.@@@@.@.@..@@.@.@@.@...@..@.@.@@@..@..@.@@@@@@.@.@@@@@' union all
-- select s_id = 58	, s = '@@.@.@@@..@@@@@@@@.@.@@@@@@.@.@@@@@..@@@@@...@@@.@@@@@@@...@@@@@..@@@@...@@@@@@..@@@.@@@@@@@..@@@@@.@..@....@.@@@@..@@..@@@.@@@@@@@.@..' union all
-- select s_id = 59	, s = '@.@@.@.@@@..@@@@@@.@@@.@.@..@@@@@@..@.@@@@@@@.@@@@@.@@@@@.@@@@..@@.@...@@@..@@@..@..@@.@@@@..@@....@@..@@@@...@.@@@..@@@.@@..@.@..@@@@@' union all
-- select s_id = 60	, s = '@@@@.@@.@.@@@@@@@@.@@@@.@.@@..@@@.@@...@@@@@@@@@@@@@@@@@@.@@....@@.@@@.@.@.@@@@@@@.@@@.@.@@.@@@@@@@@.@@@@@@@@@..@@.@@@@..@@@.@..@.@@@.@' union all
-- select s_id = 61	, s = '@..@.@@.@@@@@@@@..@@.@..@@@.@@@@@.@@@@.@.@@...@@@.@.@..@@@...@@.@@@.@@@@@@.@.@@@@.@..@@@@@@@@@.@@@@@@@.@@.@@.@@..@.@..@@@.@@@@@.@@.@@.@' union all
-- select s_id = 62	, s = '@@@.@@@@@.@@@@@..@.@@@@.@.@@@@...@@@@@@@@@@.@.@@..@@.@@...@.@@@@@.@@..@@@@@@@.@@@@..@.@@@@..@@.@.@.@.@.@..@@..@.@@@@@..@@@.@@@@@.@@@@@.' union all
-- select s_id = 63	, s = '@.......@@@@...@@..@.@.@@@@.@@.@@..@@@.@.@@@.....@@..@.....@..@@@@@@@@@.@@@@@..@@@.@@@@@@@@@@...@@@@..@..@@@.....@@@....@@.@@@..@.@..@.' union all
-- select s_id = 64	, s = '.@@.@...@@.@.@@..@..@@@@.@...@@..@@.@@@@@..@@.@.@@@.@@.@@@@.@@@@..@@@@@@@@@@@.@..@.@@.@..@.@@@@@@@.@@.@@@..@.@..@@.@@@.@.@@@@@@.@@.@...' union all
-- select s_id = 65	, s = '@@@.@@@......@@@@..@@.@..@.@@....@@...@@@@@.@@..@@@@...@@@@.@@.@@.@@..@.@@.@@@@@.@.@..@.@..@.@@@@@@@.@...@@..@@@@@@@@.@.@@@@@@@@..@..@@' union all
-- select s_id = 66	, s = '...@@@@.@..@@..@.@.....@..@.@@@...@.@@.@@@.@@@@@@@@@...@..@.@.@@..@@.@@@..@@@@@@@@.@@@.@@@@@.@@..@@.@@@@@.@@.@...@@@@@..@@.@@@@@..@@@@@' union all
-- select s_id = 67	, s = '@@...@.@@.@@.@@.@.@@@..@.@.@@@@.@@@.@@@@.@@.@@@@.@@@@.@@.@.@....@..@@@..@@@.@@@..@@@.@.@@@.@.@@@@@@.@.@.@@@@.@.@.@..@@@@.@.@..@.@.@@.@@' union all
-- select s_id = 68	, s = '@@..@....@@..@@.@.@.@@@@@@..@@@..@..@.@@@@.@@@@.@@..@@@@@@@@.@@@@.@@..@..@@...@@..@@@.@@@@@@@@...@@@@@@@@..@..@.@@@@.@@.@@@@@@@.@@@@.@@' union all
-- select s_id = 69	, s = '.@@@.@.@.@.@@..@@.@@.@@@.@@@.@@@.@@.@@@@@@@@@.@@.@..@.@.@...@@@@@@@@.@....@.@.@..@@@.@@@@@.@..@@@..@@@.@.@@@...@...@..@@@@@@@.@@@@@@@.@' union all
-- select s_id = 70	, s = '@@@@@@.@@...@@..@..@.....@..@..@@...@.@@@...@@@.@@..@..@@@@@.@.@@.@@@@....@@@@.@.@..@@@.@.@@@@@@@@@@@@.@.@@@@@@.@.@.@@@..@@..@..@@@@@.@' union all
-- select s_id = 71	, s = '...@@@@.@..@@@@@@@@@@.@@@@@.@..@@..@@@@@@.@@@...@@@@.@@.@@@....@@.@@@@@.@..@..@@@..@.@@@@..@@@@.@.@@@@@@@@@...@@...@...@@@.@@@@.@@@.@..' union all
-- select s_id = 72	, s = '@@@.@@.@@@@.@@@@@.@@@@..@@..@@@@..@@.@@@@....@@.@@....@@.@@.@..@@@.@...@.@@@@.@@.@.@.@@@@.@@@@.....@@@@@.@@@.@.@@...@@..@@.@.@@...@@.@.' union all
-- select s_id = 73	, s = '@.@@@.@@@.@.@.@.@.@@@@@.@.@.@@@..@@@@@@@@@.@@.@..@@@@@@.@@@@@..@@@@@.@@@@..@.....@@@@.@@.@@@@@@@@@@@@.@....@..@.@@@.@@..@@@..@@@@@@@...' union all
-- select s_id = 74	, s = '@@@@@@@@@@@..@..@..@.@@@@.@@.@@@@@@@@.@@.@@@@.@@@@@@....@@@.@@..@@@.@@@@@@@.@@.@.@@@.@@@..@@.@@..@...@.@..@..@...@@@@@.@@@@.@@...@@.@@@' union all
-- select s_id = 75	, s = '@@.@.@@@.@@@..@@.@.@.@.@@@@.@..@@@.@..@..@.@.@@@.@.@.@.@@@.@.@.@@@.@.@.@..@..@@@@@@.@@.@@@@.@....@.@@@.@@.@@.@@@.@...@@@@..@@@@@.@..@.@' union all
-- select s_id = 76	, s = '.@..@@@@@@@.@@@@@@.@@@@@@.@@@.@@@@@@@@@..@@.@@.@.@@@@@@.@@@...@@@.@.@@.@@@@@@.@@@@@.@@@..@@@@@@@@@@.@.@@.@.@.@@.@@@@@@@@@.....@@@@@....' union all
-- select s_id = 77	, s = '@...@@.@..@...@..@.@@@@.@@@.@@@@@.@@@@@@@..@@@@@@@@@@@@@@.@@.@..@.@@@@@@@@@@@@@@.@@@@..@@@..@...@..@@@@.@@@..@@..@@@@@@.@.@@@.@.@@@.@@@' union all
-- select s_id = 78	, s = '@@@@@@@@..@@@@@@@..@@@..@@@@@@@@@@.@.@.@@.@..@.@.@@@@..@.@@@@@@.@...@.@@.@.@@@...@@@@@@.@@.@@@@..@...@@@.@..@.@@@@..@@..@@@@@..@@@.@@.@' union all
-- select s_id = 79	, s = '@@@.@@@@..@..@@@@@@..@@..@..@@...@.@@...@.@@.@@@...@@@@@@@@.@@@@.@.@@.@@@..@.@@@@.@@.@.@.@@@.@...@@.@.@@@.....@@@@@@..@@.@@.@@@@.@.@...' union all
-- select s_id = 80	, s = '.@...@@.@.@..@@@@@.@.@..@@@@@@@..@@@@@@@@..@@@@.@@@@.@@@.@@@@@@.@@.@@.@@..@@.@@@.@..@@@.@@@@@@@@@@@@@.@.@@@...@..@@@@@@@.@.@@.@@@..@.@@' union all
-- select s_id = 81	, s = '@@@@@@...@@.@...@@@@@.@@.@@@.@...@.@..@.@.@@@@.@@@@..@.@@..@@..@@@@....@.@@@@....@..@@@@@@@@@@@@.@...@@..@..@.@@@@.@@@@.@@@@@@@.@@@@@@@' union all
-- select s_id = 82	, s = '.@@..@@.@@.@.@@...@@.@@@.@@.@@@.@@@@@.@@@@@@@@@..@.@.@@...@.@@@@@@@@@@@@..@...@.@@@@@..@@@..@.@@@@@...@....@@@....@@.@.@..@@.@.@.@.@@@.' union all
-- select s_id = 83	, s = '..@.@@..@.@@@@@@@.@@@@.@.@@.@.@@@.@@.@@@@@@@@@.@@.@@@@.@..@@@...@.@@@.@@@..@.....@@@@@@@@@@@.@@.@@@...@.@.@..@..@@..@..@..@@@.@@...@@@@' union all
-- select s_id = 84	, s = '.@@@@.@@@...@.......@@.@@@@@@@@@....@.@@@@@@.@@.@@.@.@@@.@@@@@@@...@@@...@@@@..@.@.@.@...@..@.@..@..@@@.@..@@@@@...@.@@.@@..@@.@@.@.@.@' union all
-- select s_id = 85	, s = '.@.@@@@@.@.@@.@@....@..@..@.@.@.@..@@.@@..@..@@...@@@@@.@.@@@@@...@@@..@@@.@.@..@@@@@@@@@@@@@.@@@@@@..@@@@.@@@@..@@.@@@@@@.@...@@.@@@@.' union all
-- select s_id = 86	, s = '@...@.@@@@@.@..@@@@..@..@.@@@@.@.@@.@@@@@....@@.@@@@@@@@@@.@@@@@@....@..@@@@..@..@@..@@....@..@@.@@.@.@@@@@@.@.@@.@..@@@@@@.@.@@@@@@@.@' union all
-- select s_id = 87	, s = '@@.@..@.@@..@@.@@@@@@..@@..@.@@@..@@.@@@@.@.@....@.@.@@.@...@@.@@@@..@@@@@@@@.@.@@.@@@@.@.@@...@@..@@.@@@.@@@.@@.@@@.@@@@@@@@@..@@.@@@@' union all
-- select s_id = 88	, s = '...@@@.@@.@@@@@@@@@.@.@@@@@@@..@@.@@.@@@@@..@....@@...@@@@@@@@...@@@.@@...@.@@@@@.@.@.@.@@@.@@.@....@@@..@.@@.@.@.@...@@@@@.@@..@@@.@@.' union all
-- select s_id = 89	, s = '@.@.@@@.@@@@@@.@...@@..@@@@@..@.@@....@@@..@.@@@@@.@@@@.@.@@..@@.@@..@..@@@@@@..@.@@....@@.@..@..@@@@@.@.@@@@.@.@@..@..@.@@@@@....@@.@.' union all
-- select s_id = 90	, s = '..@@@@@@@@..@.@@@@..@@@@@@@.@@....@.@@@@@.@@@@.@@.@.@@@@.@@@@@@.@@..@@.@@.@@@@@@@@@@@@@@@@@@@.@@.@@@.......@@@..@@.@@@.@@..@@@@@@@.@@.@' union all
-- select s_id = 91	, s = '@@@..@@.@@@@.@@@@@.@..@@.@@@@@.@@@..@.@.@@@@@@@.@.@@@.@.@...@@.@..@.@@@@@@@.@.@@@.@..@@..@@@..@..@@@@@@.@.@@@.@@@.@@@.....@@@@...@@..@.' union all
-- select s_id = 92	, s = '@@@@@@@@@@@.@@@.@@.@@....@@.@@..@..@@@@..@@..@.@@.@.@@@..@.@@@.@..@@.@@@..@@.@.@@@@@@.@@..@@@@.@.@.@@@@@.@@@.@@@.@@@@@@@..@.@@..@@@@.@@' union all
-- select s_id = 93	, s = '@@.@.@@.@@@.@..@@@@@@..@@@@.@.@..@@.@@@@@.@@@@.@.@..@@@@.@@@@...@@@....@@@@@@@@.@.@.@@@@..@@@..@..@@.@.@.@@@@.@.@@@@...@@.@..@@@@@@@@@@' union all
-- select s_id = 94	, s = '@.@@@@.@@..@.@....@.@@@@...@.@@.@@..@.@@@@@@.@@@@@..@@@@@@@@..@@.@@@@@@@@.@.@@.@@.@@.@@.@@.@@@@.@...@@@.@@.@@@@@.@@..@@@@@@@@@@@@.@..@@' union all
-- select s_id = 95	, s = '.@@@@.@.@@@@@@@@@@@@.@@@.@@@@@@@.@.@.@.@@@@@@..@..@@@@@..@...@@@..@@@@@@@@.@@..@@.@@@@@..@@..@@@@@@.@.@.@.@.@@.@..@.@@.@@.@@@@@@@.@@@@@' union all
-- select s_id = 96	, s = '@.@..@@@.@.@.@.@@@@@@@@@.@@@.@...@@@.@@@.@@@@@.@@.@@.@.@@@.@@@@@@@@@@@.@@@@..@.@.@@@@@@@@.@@@@..@...@.@@@@@@@@..@@@@@.@@...@.@@@@@@..@.' union all
-- select s_id = 97	, s = '@.@..@@@.@.@@@.@@@@.@.@@@@@.@.@@@@@.@@@..@@@@@.@.@@@@..@.@@@@@@.@.....@@...@...@@@.@@@.@.@@...@.@.....@@@.@@@@@..@@@.@@@@@@@@@@.@@@.@@@' union all
-- select s_id = 98	, s = '.@...@@@@@@.@.@@.@.@..@@.@@.@@.@..@.@...@.@@@@...@@...@@@.@...@@@@@.@@@@@@.@@.@.@.@@@@@@@@@.@@@@.@....@@.@@...@@.@@.@.@@..@@@@....@.@@.' union all
-- select s_id = 99	, s = '.@..@....@@@....@@@@..@@@.@@@@@.@@@@..@@...@@.@@@@@.@@..@...@@.@@.@@@...@.@@@@.@.@...@@.@@@@...@@@@@@@@@@@..@..@.@@@@@@@@@@@.@@.@@@.@..' union all
-- select s_id = 100	, s = '@.@@@@.@......@@@.@@..@...@.@..@@.@@...@@...@@.@@@@@@.@@.@@@.@.@@@@@.@.@.@@@@@@..@@@@.@@....@.@@@.@@@@@@@..@@@@@@..@@@@@@.@..@@@@@@.@@@' union all
-- select s_id = 101	, s = '..@@@@@@@@@..@.@...@@@..@@.@@@@.@@@.@..@@@@@@.@@@.@@.@@@@.@.@.@@@.@@@.@.@.@@.@@@@..@@@@.@.@.@@@@@@@.@@.@@@.@@.@@.@@@@@@@.@@@@@..@@@@.@@' union all
-- select s_id = 102	, s = '@@@@.@@.@@.@...@@..@@..@@@..@.@@..@...@.@@@..@@@@@@..@@@@@.@@@@@..@@@@@@@..@.@..@..@.@.@@.@@@@@@@@@@.@@@@@.@@..@...@@@@.@..@@.@@@@@.@@@' union all
-- select s_id = 103	, s = '.@@@@.@.@..@.@@@.@@@.@@..@@..@@@@@...@@@@@@@.@@.@.@.@@@....@@@.@.@@@@.@@@...@.@@@@.@.@@.@.@@@.@@@.@.@.@@.@...@@@@@@@.@@@@..@@@.@.@@.@@@' union all
-- select s_id = 104	, s = '.@..@.@@@@@....@@.@@.@@.@.@@..@@@@.@..@@@...@..@.@...@.@@.@...@@.@..@@..@@@..@@@@@..@.@@@@.@@.@.@.@@...@.@@@.@@.@.@@.@..@@.@@@..@@@@@.@' union all
-- select s_id = 105	, s = '.@@...@@@.@.@@@@.@@..@@@@@@.....@@@@@@@@.@@@.@@@@@.@.@@@.@@@.@.@@@..@.@@.@@@@.@.@@@@@@@@@....@..@.@@..@@@@.@.@.@@..@@@..@...@@@..@@@@..' union all
-- select s_id = 106	, s = '@@.@@@.@@@@.@@@@@@@.@@@..@@@@...@@@@.@@@.@@@@@...@.@@.@@.@@@.@@@@....@@@....@..@@@.@@..@@@@.@@.@@.@@@.@..@.@@@@..@@@...@.@.@.@@@@@@@@@@' union all
-- select s_id = 107	, s = '@@..@.@@.@@.@@.@..@.@@..@@@@@@@@@@..@@..@.@.@.@@@.@@@.@@.@@..@@@@.@@.@.@@.@@.@@@.@@@.@@.@@.@..@@..@@.@@@@@@@@@@.@@@@..@.@@@@@@@@@..@.@@' union all
-- select s_id = 108	, s = '@@@@@..@@@.@@@@@@@@@.@..@@..@@.@.@@@@@@@@.@.@@@@@@@@@@..@@@.@..@.@@@@@@.@@@...@.@@@@...@@.@.@@@@@.@.@.@@@@@@@.@.@@.@@.@..@@.@@.@.@@..@@' union all
-- select s_id = 109	, s = '@...@@.@..@@.@@.@..@@@@@@@@@.@...@@@..@@@@.@.@@@@@.@@.@.@.@.@@@@..@@@@...@..@.@.@@@@.@@@@..@.@.@..@@@@@.@.@@@@@.@@.@@@@@@@@@.@@.@.@.@.@' union all
-- select s_id = 110	, s = '@@@@@..@@@@.@@@.@.@.@.@.....@@@.@@@.@@.@@@@.@@..@@@.@..@@..@..@@@@@@...@@@@@@@.@@@...@..@@@@@@.@@@@@@@@@.@.@@@@@@@@@@..@@.......@@@@.@.' union all
-- select s_id = 111	, s = '@.@@@@@@@@@.@@@@@....@.@@@.@.@@.@@@@@@.@@@@.@.@..@@.@..@@@.....@.@.@.@.@@@@@.@...@@.@@@@@@@@...@.@@@.@@@..@@@@....@@@@.@.@@@@@..@@@.@@.' union all
-- select s_id = 112	, s = '..@@@.@@@.@..@@@..@..@@@@@.@@@@.@@..@@..@@@@.@@@...@@..@@.@@@@.@@@..@@@.@.@@.@@@@.@..@...@..@@.@.@..@....@.@.@@@.@@.@.@@@@@@@@@@@@@@@..' union all
-- select s_id = 113	, s = '@@@.@....@@@@@@@.@@@@.@@@@..@@@@..@@@@@....@@@@@.@@@@@.@@...@@..@.@.@.@@.@@@@@@@@@..@.@.@@....@.@@@@@@@@@@@.@.@@@.@.@@.@.@@..@@@@..@..@' union all
-- select s_id = 114	, s = '.@@@@@..@...@@@@@.@..@@@...@...@....@@.@@@.@@@@@.@@@.@@@@@.@@@.@@..@@.@.@.@@.@.@@.@@@@@@@@..@@.@@@@@.@@.@@@.@.@@@.@@.@@@.@.@@...@@@.@@@' union all
-- select s_id = 115	, s = '.@.@@@@@@@@@.@@@.@@@..@@..@@@.@@@@@...@@@@..@@.@@@@@@.@@...@@@@.@.@@@...@..@.@.@@.@@..@@.@.@@@@.@@.@@@@.@@.@@@.@@.@.@@@.@..@@@@..@@@@@.' union all
-- select s_id = 116	, s = '@@@...@..@@@.@.@.@.@..@@@@@@@.@..@.@@.@@@@.@@@@@@@..@.@.@@@@@@.@..@@.@@.@@@@@@@@..@.......@@@@.@@@@.@@@@.@...@.@.@@.....@@..@@....@@.@.' union all
-- select s_id = 117	, s = '.@@@.@.@.@...@@@@.@.@@@@@...@@@@@@.@@@@@@@.@@....@@..@@@.@..@@..@@@@@@.@@@@.@..@.@@@.@..@@.@@@@...@@....@@@.....@@@.@...@@...@@.@.@@@@@' union all
-- select s_id = 118	, s = '@@@@@@@@@@@.@@@@@@.@.@@.@..@@.@@@@@@.@@@@.....@@@@@@@....@.@@@..@@...@@.@@@...@@@@@@..@@@..@.@.....@@..@.@@..@@@@@@.@@@@@@.@.@.@@@@@@@@' union all
-- select s_id = 119	, s = '.@.@@.@@...@@@..@@.@@.@@.@@@@.@..@@@.@@@@@@...@..@@@.@@@@.@..@@@@.@@@.@.@@@@@.@.@@@@.@@@.@@@@@.@@@@@@@.....@.....@@.@..@..@@.@@@@@.@@.@' union all
-- select s_id = 120	, s = '@@.@@....@.@.@.@..@.@.@@.@@.@@@@.@@.@@..@.@@@..@@@......@@@@..@@..@@@@@@@..@@@.@.@@@..@.@@@@@@@@@@.@@@@@@.@.@.@.@@@@@.@.@@@@..@.@.@.@@@' union all
-- select s_id = 121	, s = '..@@@..@@@.....@@.@...@.@@..@@@....@..@.@@@..@@@@@.@@@@.@@@@@@@@.@..@@@@..@@@.@.@@.@@@.....@@@.@.@..@@@..@@@@@@.@.@.@@..@.@@@.@.@.@@@@@' union all
-- select s_id = 122	, s = '@.@@@@.@@@@@..@.@...@@@.@...@@@.@@.@.@.@@..@..@.@.@...@@...@..@@.@..@@@@@@@@@@@@@.@@@.@@...@@@@@@@@@@@.@@@.@.@@@@@..@@@@@@@....@@@@...@' union all
-- select s_id = 123	, s = '@.@.@@@@@@.@..@@.@.@@@@.@@.@@.@.@@.@@@@@@@@@@.@.@.@@@.@@.@@@...@@...@@@@@@@..@.@@@@...@@@@@@...@@@@@.@@@@@@@.@@@@@@@@@@@@@.@@@@.@@@@@@.' union all
-- select s_id = 124	, s = '@.@.@@@@.@@@@.@.@@@@.@..@@.@@@@.@.@@@..@@@.@.@.@.@@@.@.@.@.@.@@@@...@.@.@.@@@@.@@@.@@@..@..@@@@@.@.@.@.@.@@.@@@.@@@@...@@@@@@.@@.@@.@@.' union all
-- select s_id = 125	, s = '.@.@@....@@@.@..@@.@..@@....@@@@.@.@@@@@@@@.@@@@@@@@@@.@.@..@@@@.@@@@.@@@@@.@.@@.@.@@@..@@.@@.@.@@@@@@@.@.@..@@@@@@@..@..@....@@@@@..@@' union all
-- select s_id = 126	, s = '@@@@@@@..@.@@@...@@@@.@@@@@@..@@.@.@@@@..@...@.@@.@.@.@@@@..@@@...@@@.@.@@@@...@@...@@@@@@.@.@.@.@...@@@@.@@@.@.@..@@....@@@.@@..@@@@@@' union all
-- select s_id = 127	, s = '@@@@@@.@@@@.@@.@@@@.@@@@@@@@@@@@@.@@.@..@.@@@@.@@@..@@@.@.@...@.@@.@.@@@.@.@@@@@@@@@@..@@@@.@.@@@@@@@.@@@.@@@.@@@@.@@@@.@.@@@.@.@....@@' union all
-- select s_id = 128	, s = '@..@@@@@@@@.@@@@@@@@.@.@..@@@@@.@@@@@@@..@@@@@@@...@.@@..@@....@.@.@@...@.@.@@@@@@.@@@@.@.@....@.@@@@@.@.@@.@@@@@@.@@.@.@.@.@@.@@..@@.@' union all
-- select s_id = 129	, s = '@.@@......@@.@..@..@@.@.@@@@@..@@@@@......@.@.@.@@@.@@@..@@@@@.@@@@@@@.@@@......@@@.@@@.@.@@.@@@.@..@@.@@@@.@@@@@@@@@@@..@..@@@.@@@..@@' union all
-- select s_id = 130	, s = '@@@@@@@@@@@.@@@.@@..@@.@@@@.@@.@..@.@@@@@@@@..@@@@@.@@@@.@@@@@.@@.@.@.@..@@@@@@@@.@...@.@@@@@@.@@.@@@@.@.@.@@.@.@@@@..@@.@..@@@@@@@@.@.' union all
-- select s_id = 131	, s = '@@@..@@..@...@@@@@@@.@.@@@@@.@@@@.@@@.@@@@@@@@..@@@...@.@@.@..@@.@@@.@.@@...@@.@@...@@@@@@@@@@@@.@@@.@@...@.@@@.@@@@@@@@@@.@@.@@.@@@.@@' union all
-- select s_id = 132	, s = '@@@@.@@.@@@..@.@@@@@.@.@@@@@@@.@.@@.@@.@@@@.@@@.@.@.@.@@.@..@@@@@@.@.@.@@..@..@@@.@.@@@@.@@@@@@@..@.@@@.@@.@@@.@.@.@@..@@@@.@@@@.@@@@..' union all
-- select s_id = 133	, s = '@@.@@@@.@@@@@@@.@@@@@@@@@@@..@.@@.@.@.@@.@@@@@@@....@.@.@...@.@.@@@.@.@@..@@...@.@@@@.@@.@@@@@@..@.@.@@@..@..@.@.@@..@@@@@@.@...@.@@@@.' union all
-- select s_id = 134	, s = '@@..@....@@..@.@@@@.@@@.@.@.@.@.@...@@.@..........@@@@..@.@..@@.@@@@@.@@.@..@@..@@@.@....@.@@.@@@.@@.@@@..@.@@@.@.@..@@@.@@@.@.@@..@@@@' union all
-- select s_id = 135	, s = '@@@.@..@.@.@...@@@@@@.@@@@.@...@@@.@.@@@@@..@..@@..@@@@@@@@@@@@.@@.@@@@@@@@@@@.@.@@@@@@.@.@.@..@@@@@@@.@....@..@@.@@.@@.@.@@.@.@@@.@.@@' 





-- select * from #input


drop table if exists #base 


; with cte as 
(
    select s_id, id = 1, ch = left(s, 1), rem = SUBSTRING(s, 2, len(s)) from #input 
    union all 
    select s_id, id + 1, ch = left(rem, 1), rem = SUBSTRING(rem, 2, len(rem)) from cte
    where len(rem) > 0
)
select
 pos = ROW_NUMBER() over(order by s_id, id)
, r = s_id
, c = id
, ch
into #base
from cte
option (maxrecursion 0)

create index idx on #base(r, c)


; with cte as (
    select curr.pos
    , cnt_at = count(distinct case when neib.ch = '@' then neib.pos else null end)
    from #base curr
    inner join #base neib
    on abs(neib.r - curr.r) <= 1 and abs(neib.c - curr.c) <= 1 and neib.pos != curr.pos-- to find the 8 adjacent neighbours
    where curr.ch = '@' and neib.pos != curr.pos
    group by curr.pos -- order by 1, 2 
)
select ans1 = count(distinct pos) from cte
where cnt_at < 4




---- Part 2 -- To do

-- instead of update on the string and check,  using log approach to record the removeable position after each iteration

; with cte as 
(
    select total_removeable = string_agg(pos_for_concat, '') within group (order by pos) 
    , curr_removeable = string_agg(pos_for_concat, '') within group (order by pos) 
    from 
    (
        select distinct 
        pos_for_concat = '`' + cast(curr.pos as varchar) + '`'
        , curr.pos
        , cnt_at = count(case when neib.ch = '@' then neib.pos else null end) over (partition by curr.pos)
        from #base curr inner join #base neib on abs(neib.r - curr.r) <= 1 and abs(neib.c - curr.c) <= 1 -- to find the 8 adjacent neighbours
        where curr.ch = '@' and neib.pos != curr.pos
    ) _ 
    where cnt_at < 4 

    union all 
    
    select 
    total_removeable
    , curr_removeable 
    from 
    (
        select 
        total_removeable = prev_TotalRemoveable + string_agg(pos_for_concat, '') within group (order by pos)
        ,curr_removeable = string_agg(pos_for_concat, '') within group (order by pos)
        , prev_removeable
        from 
        (
            select 
            distinct 
            pos_for_concat = '`' + cast(curr.pos as varchar) + '`'
            , curr.pos
            , cnt_at = count(case when neib.ch = '@' 
                                and cte.total_removeable not like '%' +  concat('`' , cast(neib.pos as varchar) ,  '`' ) + '%' -- this position is not taken
                                then neib.pos else null end
                            ) over (partition by curr.pos)
            , prev_TotalRemoveable = cte.total_removeable   
            , prev_removeable = cte.curr_removeable  
            from cte 
            inner join #base curr on curr.c is not null -- dummy logic, just to make the recursive cte work
            inner join #base neib on abs(neib.r - curr.r) <= 1 and abs(neib.c - curr.c) <= 1 -- to find the 8 adjacent neighbours
            where curr.ch = '@' and neib.pos != curr.pos
        ) calc 
        where cnt_at < 4
    ) _ where curr_removeable != prev_removeable   
)
select * from cte 










-- ; with input as
-- (
--     select s = STRING_AGG(s, '') within group (order by s_id) from #input 
-- )
-- , base as ( -- this is the one to update
--     select pos  from 
--         (
--             select distinct 
--             curr.pos 
--             , cnt_at = count(case when neib.ch = '@' then neib.pos else null end) over (partition by curr.pos)
--             from #base curr inner join #base neib on abs(neib.r - curr.r) <= 1 and abs(neib.c - curr.c) <= 1 -- to find the 8 adjacent neighbours
--             where curr.ch = '@' and neib.pos != curr.pos
--         ) _ 
--     where cnt_at < 4 
-- )  

-- , cte as 
-- (
--     select
--     rn
--     , pos
--     , s = STUFF(input.s, pos, 1, '.')
--      from valid cross join input
--      where valid.rn = 1 

--      union all

--      select 
--      valid.rn
--      , valid.pos
--      , s = STUFF(cte.s, valid.pos, 1, '.')
--      from cte inner join valid on valid.rn = cte.rn + 1
-- )
-- select * from cte 




