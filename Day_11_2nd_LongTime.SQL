drop table if exists #input

-- select s = 'aaa: you hhh' into #input
-- union all select 'you: bbb ccc'
-- union all select 'bbb: ddd eee'
-- union all select 'ccc: ddd eee fff'
-- union all select 'ddd: ggg'
-- union all select 'eee: out'
-- union all select 'fff: out'
-- union all select 'ggg: out'
-- union all select 'hhh: ccc fff iii'
-- union all select 'iii: out'



select s = 'gif: bwy ieb det' into #input
union all select s = 'ozk: nsi gig lzz'
union all select s = 'dum: uni pwn'
union all select s = 'jur: pqx knb'
union all select s = 'lqw: tou eiu yte wio'
union all select s = 'fjf: off kco sxd'
union all select s = 'cfl: sxd'
union all select s = 'eir: avr lid'
union all select s = 'eyw: mjg mbh'
union all select s = 'zgc: out'
union all select s = 'cyp: ubl'
union all select s = 'dac: wfv efw uni vpv'
union all select s = 'dsk: juz'
union all select s = 'acm: pyh kcr jjq esx'
union all select s = 'knb: out'
union all select s = 'ixz: hxf ekm bmt'
union all select s = 'xdf: rbh'
union all select s = 'det: fnk sbj xqp vnk you'
union all select s = 'vdr: qqw'
union all select s = 'xcj: ron odf jqt'
union all select s = 'ojq: pyx mdb'
union all select s = 'fvi: shs ame'
union all select s = 'qvb: kzz geo gjk mew vur lwt kpl njw kpr mao qem sch qnu'
union all select s = 'bvj: ybk tya'
union all select s = 'myk: ekm hxf'
union all select s = 'fjh: hyr xbz'
union all select s = 'ytp: bjb egq knm'
union all select s = 'csn: fvi ifh'
union all select s = 'zjx: yym urj wsi'
union all select s = 'tou: qor gzk tfp xdf uyp ipq uvn zes yuq glz rhk nxz anc fkz mtz wil kfc isr ozk vfi'
union all select s = 'oor: mdb izs'
union all select s = 'thp: lhk jyc jgz'
union all select s = 'vwd: xri bvm'
union all select s = 'hlb: cxm mbh'
union all select s = 'nmp: izs mdb'
union all select s = 'eiz: vnk fnk you'
union all select s = 'csh: dex'
union all select s = 'mfy: iwd'
union all select s = 'qsm: scx yne usw rot'
union all select s = 'gmu: pdc nch gbj'
union all select s = 'svv: zlg'
union all select s = 'hvb: zvg upe jvt dsk'
union all select s = 'wjv: nch'
union all select s = 'mew: mfl dtj'
union all select s = 'sbj: ecb fvr kki brx fjf xun cfl leu ryp'
union all select s = 'jgi: zcp zlg woi'
union all select s = 'rcw: cay bbu'
union all select s = 'vkx: tgc zas zdv tci'
union all select s = 'tci: gia wnd'
union all select s = 'vyz: aeh wpp'
union all select s = 'ujf: yte wio'
union all select s = 'mkg: igo ctn zwb'
union all select s = 'nol: yte wio'
union all select s = 'aep: fep'
union all select s = 'otu: ohx nsu eir clx vau'
union all select s = 'jii: rof qvb'
union all select s = 'zbv: hcg mdb izs rmc'
union all select s = 'gyg: lic hlb'
union all select s = 'cot: myi'
union all select s = 'ebq: ixz myk'
union all select s = 'brx: mjq eos vdf'
union all select s = 'cnb: zrq vbo'
union all select s = 'hxf: vua tot'
union all select s = 'avr: gjb ywk rop xnp bjr'
union all select s = 'nxv: itu xxo'
union all select s = 'wfw: edr qab ggb voj kmv'
union all select s = 'gxs: bcy puo lin gqd'
union all select s = 'yet: ecw'
union all select s = 'eyh: xpn xri'
union all select s = 'gth: xiq'
union all select s = 'mtz: qxg dzs ybs'
union all select s = 'odm: mkg qmc'
union all select s = 'ltr: out'
union all select s = 'usw: lrt xpt ogf'
union all select s = 'urj: kqc zfi odm'
union all select s = 'wpt: vau clx eir ohx'
union all select s = 'ifh: shs xar ame'
union all select s = 'gnu: zgc gkk gad'
union all select s = 'shs: lbd'
union all select s = 'tzc: izs rmc hcg pyx'
union all select s = 'gzk: eun'
union all select s = 'esh: zbv wtt'
union all select s = 'tub: egq kub'
union all select s = 'jrx: dcn jyb'
union all select s = 'shy: xqp sbj fnk'
union all select s = 'gcw: ybk izk'
union all select s = 'qnu: agd ieh'
union all select s = 'qxb: usw rot scx yne'
union all select s = 'kbt: yuy'
union all select s = 'pyh: nhq ntb tbu kcd hik cro osd kqt evk qgf bhv mxm ufw uih oet yae qky ear dwi vdr kaf qlr szs gqf ohu'
union all select s = 'scx: xpt lrt ogz ogf'
union all select s = 'rmc: ayj hkp wyr evf wnb nxv snf sci hrt nfr wxu byb vyz gxs tbn ani'
union all select s = 'ajf: jdq'
union all select s = 'eun: dqo eyw mxl lic hlb'
union all select s = 'hcg: gxs byb ani snf nfr hkp'
union all select s = 'qgf: hjy thu'
union all select s = 'xiq: tou zmb eiu wio'
union all select s = 'nch: rha grb uem'
union all select s = 'qvd: eir nsu'
union all select s = 'upe: juz jse'
union all select s = 'wip: myk kqx'
union all select s = 'cgk: hju shs xar ame'
union all select s = 'kwj: wtt kuf efz'
union all select s = 'ptc: you xqp fnk sbj'
union all select s = 'ctn: koy uqj'
union all select s = 'wxu: xxo cgl'
union all select s = 'xzm: iwd rof'
union all select s = 'ekm: tot vua'
union all select s = 'iez: vwd eyh'
union all select s = 'caw: eiu zmb tou wio'
union all select s = 'sxd: cun hvb'
union all select s = 'adq: viz edy nbl bto'
union all select s = 'tyg: dtu qes kvv pne viz xry rgi fru lly'
union all select s = 'iio: rot usw scx'
union all select s = 'gjb: out'
union all select s = 'kcr: osd ohu cro ufw mxm qlr ear qky yae'
union all select s = 'mjg: esx kcr jjq ifp pyh'
union all select s = 'otm: wex pmn'
union all select s = 'bmt: tot xav'
union all select s = 'tya: ope otm'
union all select s = 'phw: ifp'
union all select s = 'off: hvb pgs inu cun'
union all select s = 'xxo: okw zbx zbs'
union all select s = 'upf: kcr'
union all select s = 'khr: wjv gmu'
union all select s = 'fju: ded kwj esh emd die'
union all select s = 'vfi: eun pyr gyg'
union all select s = 'vrx: you sbj fnk vnk xqp'
union all select s = 'uop: vuc uut nmp'
union all select s = 'rhk: gmm wfw lac'
union all select s = 'kvv: vbo'
union all select s = 'leu: hek kco off'
union all select s = 'vpp: phw xdo gtr axy lvz'
union all select s = 'zcp: det bwy'
union all select s = 'cun: jvt zvg'
union all select s = 'zbx: wio yte eiu'
union all select s = 'ykm: zui'
union all select s = 'wfk: ifh'
union all select s = 'zvg: juz gnu jse'
union all select s = 'qky: xee csn wfk'
union all select s = 'sso: hcg'
union all select s = 'ope: wex cle'
union all select s = 'ale: ecw'
union all select s = 'esx: szs ohu yae ntb nhq qky tbu ufw vdr osd kcd hik'
union all select s = 'pmn: xmk iwd qvb'
union all select s = 'pne: ice fep'
union all select s = 'lzz: ahb sit'
union all select s = 'dqo: mbh'
union all select s = 'qob: xmk'
union all select s = 'yiq: app hki jmo'
union all select s = 'okw: eiu yte tou wio'
union all select s = 'jse: zgc knh fdc'
union all select s = 'gfx: ifp jjq esx'
union all select s = 'snf: hlz eyb'
union all select s = 'swp: zmb'
union all select s = 'hkp: rxx vwd eyh'
union all select s = 'kcd: dac dum'
union all select s = 'slj: bho'
union all select s = 'qsb: izk tya'
union all select s = 'lvz: esx jjq kcr'
union all select s = 'lic: mjg mbh cxm'
union all select s = 'axy: pyh'
union all select s = 'izs: gxs tbn ani byb vyz nfr wxu sci hrt nxv eyp wnb smk hkp ayj iez wyr evf'
union all select s = 'mao: cql tci zdv zas'
union all select s = 'wnd: pyx izs rmc mdb'
union all select s = 'qab: mzw'
union all select s = 'yib: lhk'
union all select s = 'trv: dcn jyb'
union all select s = 'die: zbv wtt efz'
union all select s = 'gtr: jjq kcr pyh'
union all select s = 'ear: ykm'
union all select s = 'ecw: qvb iwd xmk rof'
union all select s = 'mxm: iio qsm qxb'
union all select s = 'ywk: out'
union all select s = 'bjr: out'
union all select s = 'uut: pyx rmc'
union all select s = 'hrt: cgl itu'
union all select s = 'wfv: vnk sbj you'
union all select s = 'kuf: hcg pyx izs'
union all select s = 'tfp: tcx rbh vut'
union all select s = 'mzw: trh acm gxd'
union all select s = 'gad: out'
union all select s = 'oqj: wpt'
union all select s = 'udc: out'
union all select s = 'baw: zth tzc uut nmp'
union all select s = 'evf: hlz aku eyb'
union all select s = 'juz: knh zgc gad fdc'
union all select s = 'fnk: kki fvr ecb umj vub cfl leu ryp trv jrx xun'
union all select s = 'jdq: wgt'
union all select s = 'ecb: mjq bfh vdf oqj'
union all select s = 'zlg: ieb shy'
union all select s = 'kub: esx ifp pyh'
union all select s = 'dex: bml kbt fgd'
union all select s = 'ryp: dcn'
union all select s = 'xpt: sym xcl'
union all select s = 'kbd: kbt lul'
union all select s = 'sym: sbj'
union all select s = 'ogz: xcl sym'
union all select s = 'lly: efr iwi ntl mpn'
union all select s = 'bml: yuy xgb'
union all select s = 'rop: out'
union all select s = 'axh: jyc jgz'
union all select s = 'gqa: sbj fnk xqp vnk you'
union all select s = 'edy: mpn rbn ntl efr iwi'
union all select s = 'koy: out'
union all select s = 'vbo: xjz dcx yon omr'
union all select s = 'jyc: xco opb upf'
union all select s = 'pqx: out'
union all select s = 'sch: ron jqt'
union all select s = 'hyr: xmk'
union all select s = 'gbj: rha uem'
union all select s = 'lya: vau clx'
union all select s = 'ice: ewq pln'
union all select s = 'mtm: gnu juz'
union all select s = 'kqs: pyx hcg mdb'
union all select s = 'cgl: lqw'
union all select s = 'zth: izs mdb pyx hcg'
union all select s = 'bpm: pdc gbj'
union all select s = 'geo: tci zdv tgc cql'
union all select s = 'lin: sqz yyl vve'
union all select s = 'rbh: fjw'
union all select s = 'sdw: gfx gxd acm'
union all select s = 'ayj: eyb hlz'
union all select s = 'ogf: eiz sym'
union all select s = 'vnk: jrx hyw cfl kki fjf xun trv brx csh ryp vub vvl umj dgi ecb zjx fvr rbr'
union all select s = 'lbd: you fnk xqp vnk'
union all select s = 'rgi: qsb iyc hhc'
union all select s = 'fmu: rof'
union all select s = 'ewq: rcw rtv'
union all select s = 'agd: emd esh kwj ded die'
union all select s = 'phd: nnk'
union all select s = 'jan: zth uut tzc'
union all select s = 'vaj: qob fvk wgt'
union all select s = 'nxz: pyr'
union all select s = 'cao: wfw lac'
union all select s = 'vvl: urj wsi puv'
union all select s = 'efw: you sbj vnk'
union all select s = 'dwi: qsm iio'
union all select s = 'gig: axh ahb'
union all select s = 'pyx: ani gxs tbn wxu nfr byb nxv snf hrt sci hkp ayj evf iez wyr smk eyp wnb'
union all select s = 'amn: fmu'
union all select s = 'mdb: gxs byb wxu sci hrt wnb eyp smk iez wyr evf ayj'
union all select s = 'vua: out'
union all select s = 'weo: gqa qyx'
union all select s = 'lhk: upf jsf xco'
union all select s = 'grb: vnk'
union all select s = 'rho: zui bpm zgq gmu'
union all select s = 'ieb: sbj xqp vnk'
union all select s = 'ame: ncp'
union all select s = 'fgd: yuy mij xgb'
union all select s = 'jyb: ebq ljq'
union all select s = 'tcx: iud fjw'
union all select s = 'igo: ltr koy zle udc'
union all select s = 'nsu: avr'
union all select s = 'aku: nds vox'
union all select s = 'ieh: kwj die'
union all select s = 'puo: sqz'
union all select s = 'jgz: jsf vkn'
union all select s = 'ifp: bhv ohu kqt qlr szs evk gqf hik kcd dwi osd vdr mxm uih yae ntb oet ear tbu'
union all select s = 'fhn: fjh amn rnz oev uxu'
union all select s = 'fjw: rmr zop jox'
union all select s = 'lul: yuy mij'
union all select s = 'iwi: yet'
union all select s = 'viz: cyp'
union all select s = 'qyx: xqp vnk fnk sbj you'
union all select s = 'wcn: cot kyz hdv'
union all select s = 'clx: avr lid vcg'
union all select s = 'qfl: bob uhj'
union all select s = 'mfl: oor pds ojq'
union all select s = 'cpd: bho hsh'
union all select s = 'kfc: gyg gnj'
union all select s = 'bcy: vve sqz'
union all select s = 'woi: ieb shy bwy'
union all select s = 'cro: csn'
union all select s = 'xbz: qvb iwd xmk'
union all select s = 'bvm: wvh'
union all select s = 'pwn: fnk sbj xqp you'
union all select s = 'zfi: qmc aoe mkg'
union all select s = 'fst: udc koy zle ltr uqj'
union all select s = 'kyz: myi'
union all select s = 'hsh: qvb rof'
union all select s = 'pln: dwj rtv'
union all select s = 'qmc: igo zwb ctn fst'
union all select s = 'mic: knm bjb'
union all select s = 'kpl: mfl'
union all select s = 'xjz: fjh rnz amn oev uxu'
union all select s = 'kll: mdb izs pyx'
union all select s = 'vve: nns nol'
union all select s = 'bjb: esx ifp'
union all select s = 'ujz: gif'
union all select s = 'ohu: khr hum ykm'
union all select s = 'pit: kll cui'
union all select s = 'kqt: khr'
union all select s = 'iud: vpp zop jox'
union all select s = 'yon: rnz'
union all select s = 'jnv: vau'
union all select s = 'fru: vbo zfs zrq'
union all select s = 'hki: out'
union all select s = 'fro: fju agd ieh'
union all select s = 'nbl: cyp fep'
union all select s = 'omr: fjh amn rnz uxu'
union all select s = 'wex: xmk'
union all select s = 'oil: fnk xqp you'
union all select s = 'gnj: eyw hlb'
union all select s = 'gxd: jjq ifp pyh esx'
union all select s = 'hlz: nds rce'
union all select s = 'byb: puo bcy lin gqd'
union all select s = 'fdc: out'
union all select s = 'qlr: iio'
union all select s = 'vkn: pyh jjq esx'
union all select s = 'efr: ale slj yet'
union all select s = 'sci: eyh mqs'
union all select s = 'yyl: nol usk'
union all select s = 'zfs: xjz fhn omr yon'
union all select s = 'tgc: gia sso wnd'
union all select s = 'app: out'
union all select s = 'rtv: jii bbu'
union all select s = 'iyc: tya'
union all select s = 'hjy: qyx gqa hoj'
union all select s = 'sit: lhk'
union all select s = 'nhq: xee csn'
union all select s = 'qes: fep ice cyp'
union all select s = 'jqt: fft'
union all select s = 'rxx: xri xpn bvm'
union all select s = 'mbh: ifp pyh esx'
union all select s = 'jee: ajf kyz tnq'
union all select s = 'bho: qvb xmk rof iwd'
union all select s = 'zmb: anc fkz mtz wil kfc isr ozk vfi uvn yuq cao glz rhk nxz gzk tfp xdf uyp ipq qor'
union all select s = 'wil: vut tcx rbh'
union all select s = 'ded: kuf'
union all select s = 'thu: gqa hoj'
union all select s = 'puv: zfi'
union all select s = 'fvr: esn dex'
union all select s = 'uem: you sbj'
union all select s = 'ybk: rfn ope'
union all select s = 'aoe: ctn zwb igo fst'
union all select s = 'oet: prw'
union all select s = 'aeh: jwd mpo'
union all select s = 'prw: zlg woi zcp'
union all select s = 'wju: iwi'
union all select s = 'wnb: eyb hlz'
union all select s = 'xnp: out'
union all select s = 'ohx: vcg'
union all select s = 'vox: wio eiu'
union all select s = 'nrz: iud fjw'
union all select s = 'lwt: fju ieh'
union all select s = 'tbn: pwb'
union all select s = 'vub: yym wsi'
union all select s = 'dgi: ehu'
union all select s = 'fvk: iwd rof xmk'
union all select s = 'tbu: dac qqw dum'
union all select s = 'sqz: usk'
union all select s = 'nns: tou'
union all select s = 'zdv: wnd'
union all select s = 'yuq: gmm lac'
union all select s = 'gxz: tot'
union all select s = 'hdv: myi'
union all select s = 'mpo: wio eiu yte'
union all select s = 'trh: kcr jjq pyh'
union all select s = 'xar: lbd xer'
union all select s = 'qqw: efw pwn uni vpv'
union all select s = 'szs: hum rho'
union all select s = 'xgb: ilk yiq'
union all select s = 'xdo: jjq pyh esx'
union all select s = 'vcg: rop xnp bjr'
union all select s = 'pds: izs mdb'
union all select s = 'ncp: sbj fnk'
union all select s = 'ixq: gxd acm gfx'
union all select s = 'gmm: ggb kmv'
union all select s = 'jmo: out'
union all select s = 'vuc: rmc hcg pyx'
union all select s = 'gqd: sqz'
union all select s = 'uyp: ybs xzn'
union all select s = 'nsi: yib sit thp ahb axh'
union all select s = 'you: vvl fvr kki jrx hyw csh leu ryp'
union all select s = 'kqx: bmt gxz ekm hxf'
union all select s = 'tlu: trh gfx gxd'
union all select s = 'yae: dum'
union all select s = 'pyr: eyw dqo hlb'
union all select s = 'jox: phw axy'
union all select s = 'zbs: zmb eiu yte wio'
union all select s = 'cay: qvb iwd xmk'
union all select s = 'njw: odf ron'
union all select s = 'yym: odm kqc'
union all select s = 'jvt: juz jse gnu'
union all select s = 'yte: ipq tfp xdf gzk qor ozk isr vfi kfc fkz mtz anc rhk nxz glz cao yuq uvn zes'
union all select s = 'smk: vwd mqs'
union all select s = 'ilk: pqx hki app jmo'
union all select s = 'rmr: gtr axy lvz'
union all select s = 'mmw: zmb eiu yte tou wio'
union all select s = 'nzb: knm egq'
union all select s = 'nds: tou zmb wio'
union all select s = 'gix: caw mmw xiq ujf'
union all select s = 'dzs: tub'
union all select s = 'izw: igo ctn zwb fst'
union all select s = 'fkz: lac'
union all select s = 'dtj: oor pds rya ojq'
union all select s = 'tnq: myi jdq vaj'
union all select s = 'mqs: xri bvm'
union all select s = 'bwy: vnk xqp fnk sbj'
union all select s = 'pwb: vzc mpo jwd'
union all select s = 'uih: thu weo gke hjy'
union all select s = 'cql: sso gia'
union all select s = 'kco: inu cun qme'
union all select s = 'aqr: rha oil ptc grb uem'
union all select s = 'rbn: ale slj yet'
union all select s = 'fft: zth tzc nmp'
union all select s = 'xcl: vnk xqp sbj fnk'
union all select s = 'nfr: rxx vwd'
union all select s = 'rce: tou yte zmb'
union all select s = 'ron: uop baw vul jan fft'
union all select s = 'hhc: izk'
union all select s = 'voj: sdw mzw ixq'
union all select s = 'lac: qab'
union all select s = 'vdf: lya jnv'
union all select s = 'ntb: jgi svv'
union all select s = 'pdc: oil ptc rha'
union all select s = 'kzz: tgc zas'
union all select s = 'vur: ron jqt'
union all select s = 'dtu: gcw bvj'
union all select s = 'opb: ifp jjq esx'
union all select s = 'lid: gjb ywk xnp'
union all select s = 'knh: out'
union all select s = 'ahb: jgz jyc lhk'
union all select s = 'ani: wpp aeh'
union all select s = 'ljq: ixz myk'
union all select s = 'hik: ujz'
union all select s = 'mxl: cxm'
union all select s = 'ufw: rho hum khr'
union all select s = 'aak: pit jgn'
union all select s = 'wxy: jee fru cnb wju lly qes pne aep wcn dtu bmi kvv edy viz xry bto rgi'
union all select s = 'kki: ehu jyb'
union all select s = 'zrq: dcx xjz fhn yon'
union all select s = 'rfn: cle pmn wex'
union all select s = 'vul: nmp vuc'
union all select s = 'qxg: nzb ytp'
union all select s = 'wsi: zfi odm kqc'
union all select s = 'pgs: upe'
union all select s = 'osd: iio'
union all select s = 'gjk: ieh agd awa fju'
union all select s = 'hju: ncp xer'
union all select s = 'gke: gqa'
union all select s = 'glz: ybs xzn qxg'
union all select s = 'zui: gbj'
union all select s = 'eos: jnv lya'
union all select s = 'bob: mke kll rnk'
union all select s = 'mke: hcg'
union all select s = 'rya: rmc'
union all select s = 'kaf: gke thu'
union all select s = 'dcn: ljq wip'
union all select s = 'kmv: nxn'
union all select s = 'xer: fnk sbj vnk you'
union all select s = 'kqc: wzi aoe izw'
union all select s = 'uqj: out'
union all select s = 'yne: ogf lrt xpt'
union all select s = 'uvn: gyg pyr gnj'
union all select s = 'umj: tts'
union all select s = 'qor: xzn qxg dzs'
union all select s = 'dcx: oev uxu amn'
union all select s = 'zas: wnd'
union all select s = 'gqf: weo gke hjy thu'
union all select s = 'vau: vcg'
union all select s = 'uhj: cui mke kqs rnk kll'
union all select s = 'rof: qem phd kpr mao kpl njw mew vur aak geo qfl gjk kzz xcj fro vkx'
union all select s = 'jsf: esx ifp'
union all select s = 'edr: sdw ixq mzw'
union all select s = 'emd: kuf'
union all select s = 'vzc: tou eiu'
union all select s = 'fep: pln ubl'
union all select s = 'eot: zop jox vpp'
union all select s = 'cxm: esx ifp pyh jjq kcr'
union all select s = 'wtt: pyx rmc'
union all select s = 'xqp: hyw jrx leu kki csh brx trv fjf vub ryp ecb dgi vvl fvr rbr zjx'
union all select s = 'wpp: vzc'
union all select s = 'bmi: iyc bvj qsb'
union all select s = 'lrt: eiz xcl vrx'
union all select s = 'xav: out'
union all select s = 'bfh: wpt lya qvd'
union all select s = 'odf: vul jan baw'
union all select s = 'eiu: ipq uyp tfp gzk qor isr ozk vfi wil fkz mtz anc rhk nxz glz cao yuq uvn zes'
union all select s = 'egq: esx ifp pyh kcr jjq'
union all select s = 'xun: vdf oqj'
union all select s = 'bhv: hjy'
union all select s = 'esn: kbt bml lul'
union all select s = 'mjq: otu'
union all select s = 'nxn: acm'
union all select s = 'xri: gth'
union all select s = 'wzi: fst'
union all select s = 'iwd: mew qem gjk kpr fro xcj'
union all select s = 'svr: adq mkr tyg wxy'
union all select s = 'knm: jjq kcr'
union all select s = 'tts: kbt fgd bml'
union all select s = 'ubl: rcw rtv dwj'
union all select s = 'jgn: kqs rnk cui mke'
union all select s = 'wyr: gqd bcy'
union all select s = 'isr: ybs xzn qxg'
union all select s = 'anc: lzz'
union all select s = 'hyw: hek'
union all select s = 'uyx: rnk kll kqs mke cui'
union all select s = 'wvh: ujf caw'
union all select s = 'mij: yiq jur ilk'
union all select s = 'qem: zdv'
union all select s = 'ipq: nrz'
union all select s = 'rbr: kbd tts'
union all select s = 'ehu: wip ljq'
union all select s = 'cui: hcg rmc mdb'
union all select s = 'mkr: edy pne kvv rgi jee cnb fru wju lly'
union all select s = 'uxu: xbz xzm'
union all select s = 'oev: mfy xzm xbz'
union all select s = 'eyb: vox'
union all select s = 'vpv: you sbj vnk xqp'
union all select s = 'wio: vfi isr kfc wil uyp xdf tfp anc nxz cao zes uvn'
union all select s = 'zwb: ltr'
union all select s = 'gkk: out'
union all select s = 'nnk: csw rya'
union all select s = 'xco: ifp'
union all select s = 'hek: inu qme hvb'
union all select s = 'efz: mdb rmc'
union all select s = 'zgq: pdc aqr'
union all select s = 'itu: zbs swp zbx okw'
union all select s = 'inu: dsk mtm'
union all select s = 'xpn: gth gix'
union all select s = 'rnz: xzm'
union all select s = 'mpn: yet cpd'
union all select s = 'eyp: cgl xxo'
union all select s = 'wgt: xmk rof iwd qvb'
union all select s = 'zle: out'
union all select s = 'kpr: pit uyx uhj'
union all select s = 'evk: jgi svv'
union all select s = 'zop: phw axy lvz'
union all select s = 'myi: qob wgt'
union all select s = 'bbu: qvb'
union all select s = 'xmk: xcj fro vkx kzz qfl gjk aak geo vur mew lwt njw kpl mao kpr qnu sch phd qem'
union all select s = 'zes: nsi'
union all select s = 'ybs: ytp nzb mic'
union all select s = 'bto: rbn'
union all select s = 'hoj: vnk sbj'
union all select s = 'tot: out'
union all select s = 'qme: mtm dsk jvt upe zvg'
union all select s = 'yuy: jur'
union all select s = 'awa: die esh'
union all select s = 'vut: eot iud'
union all select s = 'cle: qvb xmk rof'
union all select s = 'xry: tnq ajf cot kyz'
union all select s = 'rot: xpt ogf ogz'
union all select s = 'izk: rfn otm'
union all select s = 'csw: hcg izs rmc mdb'
union all select s = 'uni: xqp you'
union all select s = 'rha: you fnk'
union all select s = 'ggb: ixq nxn tlu'
union all select s = 'xzn: mic nzb'
union all select s = 'gia: pyx hcg rmc mdb'
union all select s = 'xee: cgk'
union all select s = 'hum: bpm zgq zui wjv'
union all select s = 'jwd: wio eiu yte zmb'
union all select s = 'rnk: pyx hcg rmc izs'
union all select s = 'ntl: ale cpd'
union all select s = 'jjq: ohu qgf evk kaf kqt qlr dwi hik yae ntb ufw'
union all select s = 'dwj: cay jii bbu'
union all select s = 'usk: zmb yte eiu'




drop table if exists #base 

; with base as (
select 
starting = parsename(replace(s, ':', '.'), 2)
, connected = ltrim(parsename(replace(s, ':', '.'), 1)) + ' '
from #input
)
, cte as 
(
    select starting, n = 1, machine = left(connected, CHARINDEX(' ',connected)-1), rem = SUBSTRING(connected, CHARINDEX(' ', connected)+1, len(connected))
    from base
    union ALL
    select 
    starting
    , n+ 1
    , left(rem, CHARINDEX(' ', rem)-1)
    , SUBSTRING(rem, CHARINDEX(' ', rem) + 1, len(rem))
    from cte 
    where len(rem) > 1
)
select * into #base from cte 
OPTION(maxrecursion 0)


drop table if exists #res

; with cte as (
select 
starting
, n 
, machine
, paths = cast('>' + starting + '>' + machine + '>' as varchar(max)) 
from #base
where starting = 'you'

union all 

select 
c.starting
, b.n
, b.machine
, cast(c.paths + '>' + b.machine + '>' as varchar(max))
from cte c inner join #base b 
on c.machine = b.starting and c.paths not like '%>' + b.machine +'>%'
)
select * into #res
from cte 
option (maxrecursion 0 )


select ans1 = count(*) from #res
where starting = 'you' and machine = 'out'
option (maxrecursion 0 )


 
----- part 2
--- -- 20251211_111115 Taking long time to run
-- Getting correct answer with Python - 332052564714990 - not feasible with SQL for brutal force


drop table if exists #res_2

; with cte as (
select 
starting
, n 
, machine
, paths = cast('>' + starting + '>' + machine + '>' as varchar(max)) 
from #base
where starting = 'svr'

union all 

select 
c.starting
, b.n
, b.machine
, cast(c.paths + '>' + b.machine + '>' as varchar(max))
from cte c inner join #base b 
on c.machine = b.starting and c.paths not like '%>' + b.machine +'>%'
)
select * into #res_2
from cte 
option (maxrecursion 0 )


select ans2 = count(*) from #res_2
where  machine = 'out' and paths like '%>dac>%' and paths like '%>fft>%'
option (maxrecursion 0 )



